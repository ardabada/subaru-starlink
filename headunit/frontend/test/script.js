(()=>{"use strict";const t={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937},e=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||t[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},n=6378137,i=Math.PI*n,r=[-i,-i,i,i],s=[-180,-85,180,85],o=n*Math.log(Math.tan(Math.PI/2));class a extends e{constructor(t){super({code:t,units:"m",extent:r,global:!0,worldExtent:s,getPointResolution:function(t,e){return t/Math.cosh(e[1]/n)}})}}const l=[new a("EPSG:3857"),new a("EPSG:102100"),new a("EPSG:102113"),new a("EPSG:900913"),new a("http://www.opengis.net/def/crs/EPSG/0/3857"),new a("http://www.opengis.net/gml/srs/epsg.xml#3857")];const h=[-180,-90,180,90],u=6378137*Math.PI/180;class c extends e{constructor(t,e){super({code:t,units:"degrees",extent:h,axisOrientation:e,global:!0,metersPerUnit:u,worldExtent:h})}}const d=[new c("CRS:84"),new c("EPSG:4326","neu"),new c("urn:ogc:def:crs:OGC:1.3:CRS84"),new c("urn:ogc:def:crs:OGC:2:84"),new c("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new c("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new c("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let p={},g={};function f(t,e,n){const i=t.getCode(),r=e.getCode();i in g||(g[i]={}),g[i][r]=n}const m={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function v(t,e,n){let i,r;return i=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0,r=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0,i*i+r*r}function y(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function _(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function x(t,e){const n=t[0],i=t[1],r=t[2],s=t[3],o=e[0],a=e[1];let l=m.UNKNOWN;return o<n?l|=m.LEFT:o>r&&(l|=m.RIGHT),a<i?l|=m.BELOW:a>s&&(l|=m.ABOVE),l===m.UNKNOWN&&(l=m.INTERSECTING),l}function b(t,e,n,i,r){return r?(r[0]=t,r[1]=e,r[2]=n,r[3]=i,r):[t,e,n,i]}function C(t){return b(1/0,1/0,-1/0,-1/0,t)}function w(t,e,n,i,r){return P(C(r),t,e,n,i)}function E(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function P(t,e,n,i,r){for(;n<i;n+=r)R(t,e[n],e[n+1]);return t}function R(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function M(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function I(t,e,n,i,r){const[s,o,a,l,h,u,c,d]=function(t,e,n,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(n),a=Math.sin(n),l=r*o,h=r*a,u=s*o,c=s*a,d=t[0],p=t[1];return[d-l+c,p-h-u,d-l-c,p-h+u,d+l-c,p+h+u,d+l+c,p+h-u,d-l+c,p-h-u]}(t,e,n,i);return b(Math.min(s,a,h,c),Math.min(o,l,u,d),Math.max(s,a,h,c),Math.max(o,l,u,d),r)}function L(t){return t[3]-t[1]}function T(t,e,n){const i=n||[1/0,1/0,-1/0,-1/0];return k(t,e)?(t[0]>e[0]?i[0]=t[0]:i[0]=e[0],t[1]>e[1]?i[1]=t[1]:i[1]=e[1],t[2]<e[2]?i[2]=t[2]:i[2]=e[2],t[3]<e[3]?i[3]=t[3]:i[3]=e[3]):C(i),i}function S(t){return t[2]-t[0]}function k(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function A(t){return t[2]<t[0]||t[3]<t[1]}function F(t,e){let n=!0;for(let i=t.length-1;i>=0;--i)if(t[i]!=e[i]){n=!1;break}return n}function D(t,e){const n=Math.cos(e),i=Math.sin(e),r=t[0]*n-t[1]*i,s=t[1]*n+t[0]*i;return t[0]=r,t[1]=s,t}const N={info:1,warn:2,error:3,none:4};let O=N.info;function z(...t){O>N.warn||console.warn(...t)}let G=!0;function j(t,e){if(void 0!==e)for(let n=0,i=t.length;n<i;++n)e[n]=t[n];else e=t.slice();return e}function V(t,e){if(void 0!==e&&t!==e){for(let n=0,i=t.length;n<i;++n)e[n]=t[n];t=e}return t}function K(t){!function(t,e){p[t]=e}(t.getCode(),t),f(t,t,j)}function Z(t){return"string"==typeof t?p[e=t]||p[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function q(t){!function(t){t.forEach(K)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&f(e,t,j)}))}))}function U(t,e){return t?"string"==typeof t?Z(t):t:Z(e)}function B(t,e){let n=function(t,e){let n;return t in g&&e in g[t]&&(n=g[t][e]),n}(t.getCode(),e.getCode());return n||(n=V),n}function X(t,e){return B(Z(t),Z(e))}function H(t,e,n){return X(e,n)(t,void 0,t.length)}function Y(t,e,n,i){return function(t,e,n,i){let r=[];if(i>1){const e=t[2]-t[0],n=t[3]-t[1];for(let s=0;s<i;++s)r.push(t[0]+e*s/i,t[1],t[2],t[1]+n*s/i,t[2]-e*s/i,t[3],t[0],t[3]-n*s/i)}else r=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(r,r,2);const s=[],o=[];for(let t=0,e=r.length;t<e;t+=2)s.push(r[t]),o.push(r[t+1]);return function(t,e,n){return b(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),n)}(s,o,n)}(t,X(e,n),void 0,i)}let W=null;function J(){return W}function $(t,e){return W?H(t,e,W):t}function Q(t,e){return W?H(t,W,e):(G&&!F(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(G=!1,z("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t)}function tt(t,e){return W?Y(t,W,e):t}var et,nt,it;q(l),q(d),et=l,nt=function(t,e,r){const s=t.length;r=r>1?r:2,void 0===e&&(e=r>2?t.slice():new Array(s));for(let a=0;a<s;a+=r){e[a]=i*t[a]/180;let r=n*Math.log(Math.tan(Math.PI*(+t[a+1]+90)/360));r>o?r=o:r<-o&&(r=-o),e[a+1]=r}return e},it=function(t,e,r){const s=t.length;r=r>1?r:2,void 0===e&&(e=r>2?t.slice():new Array(s));for(let o=0;o<s;o+=r)e[o]=180*t[o]/i,e[o+1]=360*Math.atan(Math.exp(t[o+1]/n))/Math.PI-90;return e},d.forEach((function(t){et.forEach((function(e){f(t,e,nt),f(e,t,it)}))}));const rt=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},st="propertychange",ot=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function at(t,e){return t>e?1:t<e?-1:0}function lt(t,e,n){const i=t.length;if(t[0]<=e)return 0;if(e<=t[i-1])return i-1;let r;if(n>0){for(r=1;r<i;++r)if(t[r]<e)return r-1}else if(n<0){for(r=1;r<i;++r)if(t[r]<=e)return r}else for(r=1;r<i;++r){if(t[r]==e)return r;if(t[r]<e)return"function"==typeof n?n(e,t[r-1],t[r])>0?r-1:r:t[r-1]-e<e-t[r]?r-1:r}return i-1}function ht(t,e){const n=Array.isArray(e)?e:[e],i=n.length;for(let e=0;e<i;e++)t[t.length]=n[e]}function ut(t,e){const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function ct(){return!0}function dt(){return!1}function pt(){}function gt(t){for(const e in t)delete t[e]}function ft(t){let e;for(e in t)return!1;return!e}const mt=class extends ot{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const n=this.listeners_||(this.listeners_={}),i=n[t]||(n[t]=[]);i.includes(e)||i.push(e)}dispatchEvent(t){const e="string"==typeof t,n=e?t:t.type,i=this.listeners_&&this.listeners_[n];if(!i)return;const r=e?new rt(t):t;r.target||(r.target=this.eventTarget_||this);const s=this.dispatching_||(this.dispatching_={}),o=this.pendingRemovals_||(this.pendingRemovals_={});let a;n in s||(s[n]=0,o[n]=0),++s[n];for(let t=0,e=i.length;t<e;++t)if(a="handleEvent"in i[t]?i[t].handleEvent(r):i[t].call(this,r),!1===a||r.propagationStopped){a=!1;break}if(0==--s[n]){let t=o[n];for(delete o[n];t--;)this.removeEventListener(n,pt);delete s[n]}return a}disposeInternal(){this.listeners_&&gt(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(t,e){const n=this.listeners_&&this.listeners_[t];if(n){const i=n.indexOf(e);-1!==i&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[i]=pt,++this.pendingRemovals_[t]):(n.splice(i,1),0===n.length&&delete this.listeners_[t]))}}},vt="change",yt="contextmenu",_t="click",xt="keydown",bt="keypress",Ct="touchmove",wt="wheel";function Et(t,e,n,i,r){if(i&&i!==t&&(n=n.bind(i)),r){const i=n;n=function(){t.removeEventListener(e,n),i.apply(this,arguments)}}const s={target:t,type:e,listener:n};return t.addEventListener(e,n),s}function Pt(t,e,n,i){return Et(t,e,n,i,!0)}function Rt(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),gt(t))}class Mt extends mt{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(vt)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const n=t.length,i=new Array(n);for(let r=0;r<n;++r)i[r]=Et(this,t[r],e);return i}return Et(this,t,e)}onceInternal(t,e){let n;if(Array.isArray(t)){const i=t.length;n=new Array(i);for(let r=0;r<i;++r)n[r]=Pt(this,t[r],e)}else n=Pt(this,t,e);return e.ol_key=n,n}unInternal(t,e){const n=e.ol_key;if(n)!function(t){if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)Rt(t[e]);else Rt(t)}(n);else if(Array.isArray(t))for(let n=0,i=t.length;n<i;++n)this.removeEventListener(t[n],e);else this.removeEventListener(t,e)}}Mt.prototype.on,Mt.prototype.once,Mt.prototype.un;const It=Mt;function Lt(){throw new Error("Unimplemented abstract method.")}let Tt=0;function St(t){return t.ol_uid||(t.ol_uid=String(++Tt))}class kt extends rt{constructor(t,e,n){super(t),this.key=e,this.oldValue=n}}const At=class extends It{constructor(t){super(),this.on,this.once,this.un,St(this),this.values_=null,void 0!==t&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}hasProperties(){return!!this.values_}notify(t,e){let n;n=`change:${t}`,this.hasListener(n)&&this.dispatchEvent(new kt(n,t,e)),n=st,this.hasListener(n)&&this.dispatchEvent(new kt(n,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,n){const i=this.values_||(this.values_={});if(n)i[t]=e;else{const n=i[t];i[t]=e,n!==e&&this.notify(t,n)}}setProperties(t,e){for(const n in t)this.set(n,t[n],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const n=this.values_[t];delete this.values_[t],ft(this.values_)&&(this.values_=null),e||this.notify(t,n)}}},Ft={1:"The view center is not defined",2:"The view resolution is not defined",3:"The view rotation is not defined",4:"`image` and `src` cannot be provided at the same time",5:"`imgSize` must be set when `image` is provided",7:"`format` must be set when `url` is set",8:"Unknown `serverType` configured",9:"`url` must be configured or set using `#setUrl()`",10:"The default `geometryFunction` can only handle `Point` geometries",11:"`options.featureTypes` must be an Array",12:"`options.geometryName` must also be provided when `options.bbox` is set",13:"Invalid corner",14:"Invalid color",15:"Tried to get a value for a key that does not exist in the cache",16:"Tried to set a value for a key that is used already",17:"`resolutions` must be sorted in descending order",18:"Either `origin` or `origins` must be configured, never both",19:"Number of `tileSizes` and `resolutions` must be equal",20:"Number of `origins` and `resolutions` must be equal",22:"Either `tileSize` or `tileSizes` must be configured, never both",24:"Invalid extent or geometry provided as `geometry`",25:"Cannot fit empty extent provided as `geometry`",26:"Features must have an id set",27:"Features must have an id set",28:'`renderMode` must be `"hybrid"` or `"vector"`',30:"The passed `feature` was already added to the source",31:"Tried to enqueue an `element` that was already added to the queue",32:"Transformation matrix cannot be inverted",33:"Invalid units",34:"Invalid geometry layout",36:"Unknown SRS type",37:"Unknown geometry type found",38:"`styleMapValue` has an unknown type",39:"Unknown geometry type",40:"Expected `feature` to have a geometry",41:"Expected an `ol/style/Style` or an array of `ol/style/Style.js`",42:"Question unknown, the answer is 42",43:"Expected `layers` to be an array or a `Collection`",47:"Expected `controls` to be an array or an `ol/Collection`",48:"Expected `interactions` to be an array or an `ol/Collection`",49:"Expected `overlays` to be an array or an `ol/Collection`",50:"`options.featureTypes` should be an Array",51:"Either `url` or `tileJSON` options must be provided",52:"Unknown `serverType` configured",53:"Unknown `tierSizeCalculation` configured",55:"The {-y} placeholder requires a tile grid with extent",56:"mapBrowserEvent must originate from a pointer event",57:"At least 2 conditions are required",59:"Invalid command found in the PBF",60:"Missing or invalid `size`",61:"Cannot determine IIIF Image API version from provided image information JSON",62:"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",64:"Layer opacity must be a number",66:"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",67:"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",68:"A VectorTile source can only be rendered if it has a projection compatible with the view projection",69:"`width` or `height` cannot be provided together with `scale`"};class Dt extends Error{constructor(t){const e=Ft[t];super(e),this.code=t,this.name="AssertionError",this.message=e}}const Nt=Dt,Ot="add",zt="remove",Gt="length";class jt extends rt{constructor(t,e,n){super(t),this.element=e,this.index=n}}const Vt=class extends At{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let t=0,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,n=t.length;e<n;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let n=0,i=e.length;n<i;++n)t(e[n],n,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(Gt)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new jt(Ot,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let n=0,i=e.length;n<i;++n)if(e[n]===t)return this.removeAt(n)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new jt(zt,e,t)),e}setAt(t,e){if(t>=this.getLength())return void this.insertAt(t,e);if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new jt(zt,n,t)),this.dispatchEvent(new jt(Ot,e,t))}updateLength_(){this.set(Gt,this.array_.length)}assertUnique_(t,e){for(let n=0,i=this.array_.length;n<i;++n)if(this.array_[n]===t&&n!==e)throw new Nt(58)}};function Kt(t,e){if(!t)throw new Nt(e)}function Zt(t,e){const n=e[0],i=e[1];return e[0]=t[0]*n+t[2]*i+t[4],e[1]=t[1]*n+t[3]*i+t[5],e}function qt(t,e,n,i,r,s,o,a){const l=Math.sin(s),h=Math.cos(s);return t[0]=i*h,t[1]=r*l,t[2]=-i*l,t[3]=r*h,t[4]=o*i*h-a*i*l+e,t[5]=o*r*l+a*r*h+n,t}function Ut(t,e,n){return Math.min(Math.max(t,e),n)}function Bt(t,e,n,i,r,s){const o=r-n,a=s-i;if(0!==o||0!==a){const l=((t-n)*o+(e-i)*a)/(o*o+a*a);l>1?(n=r,i=s):l>0&&(n+=o*l,i+=a*l)}return Xt(t,e,n,i)}function Xt(t,e,n,i){const r=n-t,s=i-e;return r*r+s*s}function Ht(t,e){const n=t%e;return n*e<0?n+e:n}function Yt(t,e,n){return t+n*(e-t)}new Array(6);function Wt(t,e,n){return e+":"+t+":"+(n?function(t){return"string"==typeof t?t:function(t){let e=t[0];e!=(0|e)&&(e=e+.5|0);let n=t[1];n!=(0|n)&&(n=n+.5|0);let i=t[2];return i!=(0|i)&&(i=i+.5|0),"rgba("+e+","+n+","+i+","+(void 0===t[3]?1:Math.round(100*t[3])/100)+")"}(t)}(n):"null")}const Jt=new class{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const n=this.cache_[e];0!=(3&t++)||n.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}}get(t,e,n){const i=Wt(t,e,n);return i in this.cache_?this.cache_[i]:null}set(t,e,n,i){const r=Wt(t,e,n);this.cache_[r]=i,++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}},$t="opacity",Qt="visible",te="extent",ee="zIndex",ne="maxResolution",ie="minResolution",re="maxZoom",se="minZoom",oe="source",ae=class extends At{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);"object"==typeof t.properties&&(delete e.properties,Object.assign(e,t.properties)),e[$t]=void 0!==t.opacity?t.opacity:1,Kt("number"==typeof e[$t],64),e[Qt]=void 0===t.visible||t.visible,e[ee]=t.zIndex,e[ne]=void 0!==t.maxResolution?t.maxResolution:1/0,e[ie]=void 0!==t.minResolution?t.minResolution:0,e[se]=void 0!==t.minZoom?t.minZoom:-1/0,e[re]=void 0!==t.maxZoom?t.maxZoom:1/0,this.className_=void 0!==e.className?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:void 0===t||t},n=this.getZIndex();return e.opacity=Ut(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==n||e.managed?n:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return Lt()}getLayerStatesArray(t){return Lt()}getExtent(){return this.get(te)}getMaxResolution(){return this.get(ne)}getMinResolution(){return this.get(ie)}getMinZoom(){return this.get(se)}getMaxZoom(){return this.get(re)}getOpacity(){return this.get($t)}getSourceState(){return Lt()}getVisible(){return this.get(Qt)}getZIndex(){return this.get(ee)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(te,t)}setMaxResolution(t){this.set(ne,t)}setMinResolution(t){this.set(ie,t)}setMaxZoom(t){this.set(re,t)}setMinZoom(t){this.set(se,t)}setOpacity(t){Kt("number"==typeof t,64),this.set($t,t)}setVisible(t){this.set(Qt,t)}setZIndex(t){this.set(ee,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},le="precompose",he="rendercomplete",ue={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function ce(t,e,n){return function(i,r,s,o,a){if(!i)return;if(!r&&!e)return i;const l=e?0:s[0]*r,h=e?0:s[1]*r,u=a?a[0]:0,c=a?a[1]:0;let d=t[0]+l/2+u,p=t[2]-l/2+u,g=t[1]+h/2+c,f=t[3]-h/2+c;d>p&&(d=(p+d)/2,p=d),g>f&&(g=(f+g)/2,f=g);let m=Ut(i[0],d,p),v=Ut(i[1],g,f);if(o&&n&&r){const t=30*r;m+=-t*Math.log(1+Math.max(0,d-i[0])/t)+t*Math.log(1+Math.max(0,i[0]-p)/t),v+=-t*Math.log(1+Math.max(0,g-i[1])/t)+t*Math.log(1+Math.max(0,i[1]-f)/t)}return[m,v]}}function de(t){return t}function pe(t,e,n,i){const r=S(e)/n[0],s=L(e)/n[1];return i?Math.min(t,Math.max(r,s)):Math.min(t,Math.min(r,s))}function ge(t,e,n){let i=Math.min(t,e);return i*=Math.log(1+50*Math.max(0,t/e-1))/50+1,n&&(i=Math.max(i,n),i/=Math.log(1+50*Math.max(0,n/t-1))/50+1),Ut(i,n/2,2*e)}function fe(t,e,n,i,r){return n=void 0===n||n,function(s,o,a,l){if(void 0!==s){const o=i?pe(t,i,a,r):t;return n&&l?ge(s,o,e):Ut(s,e,o)}}}function me(t){if(void 0!==t)return 0}function ve(t){if(void 0!==t)return t}function ye(t){return 1-function(t){return Math.pow(t,3)}(1-t)}function _e(t){return 3*t*t-2*t*t*t}function xe(t){return t}const be=[1,0,0,1,0,0],Ce=class extends At{constructor(){super(),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=function(t){let e,n,i,r=!1;return function(){const s=Array.prototype.slice.call(arguments);return r&&this===i&&ut(s,n)||(r=!0,i=this,n=s,e=t.apply(this,arguments)),e}}((function(t,e,n){if(!n)return this.getSimplifiedGeometry(e);const i=this.clone();return i.applyTransform(n),i.getSimplifiedGeometry(e)}))}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return Lt()}closestPointXY(t,e,n,i){return Lt()}containsXY(t,e){const n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return Lt()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&C(t),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)}rotate(t,e){Lt()}scale(t,e,n){Lt()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return Lt()}getType(){return Lt()}applyTransform(t){Lt()}intersectsExtent(t){return Lt()}translate(t,e){Lt()}transform(t,e){const n=Z(t),i="tile-pixels"==n.getUnits()?function(t,i,r){const s=n.getExtent(),o=n.getWorldExtent(),a=L(o)/L(s);return qt(be,o[0],o[3],a,-a,0,0,0),function(t,e,n,i,r,s){s=s||[];let o=0;for(let e=0;e<n;e+=i){const n=t[e],i=t[e+1];s[o++]=r[0]*n+r[2]*i+r[4],s[o++]=r[1]*n+r[3]*i+r[5]}s&&s.length!=o&&(s.length=o)}(t,0,t.length,r,be,i),X(n,e)(t,i,r)}:X(n,e);return this.applyTransform(i),this}};function we(t){let e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}const Ee=class extends Ce{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates=null}computeExtent(t){return w(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return Lt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=we(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){Lt()}setLayout(t,e,n){let i;if(t)i=we(t);else{for(let t=0;t<n;++t){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}i=e.length,t=function(t){let e;return 2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM"),e}(i)}this.layout=t,this.stride=i}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const n=this.getFlatCoordinates();if(n){const i=this.getStride();!function(t,e,n,i,r,s,o){o=o||[];const a=Math.cos(r),l=Math.sin(r),h=s[0],u=s[1];let c=0;for(let e=0;e<n;e+=i){const n=t[e]-h,r=t[e+1]-u;o[c++]=h+n*a-r*l,o[c++]=u+n*l+r*a;for(let n=e+2;n<e+i;++n)o[c++]=t[n]}o&&o.length!=c&&(o.length=c)}(n,0,n.length,i,t,e,n),this.changed()}}scale(t,e,n){void 0===e&&(e=t),n||(n=M(this.getExtent()));const i=this.getFlatCoordinates();if(i){const r=this.getStride();!function(t,e,n,i,r,s,o,a){a=a||[];const l=o[0],h=o[1];let u=0;for(let e=0;e<n;e+=i){const n=t[e]-l,o=t[e+1]-h;a[u++]=l+r*n,a[u++]=h+s*o;for(let n=e+2;n<e+i;++n)a[u++]=t[n]}a&&a.length!=u&&(a.length=u)}(i,0,i.length,r,t,e,n,i),this.changed()}}translate(t,e){const n=this.getFlatCoordinates();if(n){const i=this.getStride();!function(t,e,n,i,r,s,o){o=o||[];let a=0;for(let e=0;e<n;e+=i){o[a++]=t[e]+r,o[a++]=t[e+1]+s;for(let n=e+2;n<e+i;++n)o[a++]=t[n]}o&&o.length!=a&&(o.length=a)}(n,0,n.length,i,t,e,n),this.changed()}}};function Pe(t,e,n,i,r,s,o){const a=t[e],l=t[e+1],h=t[n]-a,u=t[n+1]-l;let c;if(0===h&&0===u)c=e;else{const d=((r-a)*h+(s-l)*u)/(h*h+u*u);if(d>1)c=n;else{if(d>0){for(let r=0;r<i;++r)o[r]=Yt(t[e+r],t[n+r],d);return void(o.length=i)}c=e}}for(let e=0;e<i;++e)o[e]=t[c+e];o.length=i}function Re(t,e,n,i,r){let s=t[e],o=t[e+1];for(e+=i;e<n;e+=i){const n=t[e],i=t[e+1],a=Xt(s,o,n,i);a>r&&(r=a),s=n,o=i}return r}function Me(t,e,n,i,r){for(let s=0,o=n.length;s<o;++s){const o=n[s];r=Re(t,e,o,i,r),e=o}return r}function Ie(t,e,n,i,r,s,o,a,l,h,u){if(e==n)return h;let c,d;if(0===r){if(d=Xt(o,a,t[e],t[e+1]),d<h){for(c=0;c<i;++c)l[c]=t[e+c];return l.length=i,d}return h}u=u||[NaN,NaN];let p=e+i;for(;p<n;)if(Pe(t,p-i,p,i,o,a,u),d=Xt(o,a,u[0],u[1]),d<h){for(h=d,c=0;c<i;++c)l[c]=u[c];l.length=i,p+=i}else p+=i*Math.max((Math.sqrt(d)-Math.sqrt(h))/r|0,1);if(s&&(Pe(t,n-i,e,i,o,a,u),d=Xt(o,a,u[0],u[1]),d<h)){for(h=d,c=0;c<i;++c)l[c]=u[c];l.length=i}return h}function Le(t,e,n,i,r,s,o,a,l,h,u){u=u||[NaN,NaN];for(let c=0,d=n.length;c<d;++c){const d=n[c];h=Ie(t,e,d,i,r,s,o,a,l,h,u),e=d}return h}function Te(t,e,n,i){for(let r=0,s=n.length;r<s;++r){const s=n[r];for(let n=0;n<i;++n)t[e++]=s[n]}return e}function Se(t,e,n,i,r){r=r||[];let s=0;for(let o=0,a=n.length;o<a;++o){const a=Te(t,e,n[o],i);r[s++]=a,e=a}return r.length=s,r}function ke(t,e,n,i,r,s,o){const a=(n-e)/i;if(a<3){for(;e<n;e+=i)s[o++]=t[e],s[o++]=t[e+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const h=[e,n-i];let u=0;for(;h.length>0;){const n=h.pop(),s=h.pop();let o=0;const a=t[s],c=t[s+1],d=t[n],p=t[n+1];for(let e=s+i;e<n;e+=i){const n=Bt(t[e],t[e+1],a,c,d,p);n>o&&(u=e,o=n)}o>r&&(l[(u-e)/i]=1,s+i<u&&h.push(s,u),u+i<n&&h.push(u,n))}for(let n=0;n<a;++n)l[n]&&(s[o++]=t[e+n*i],s[o++]=t[e+n*i+1]);return o}function Ae(t,e){return e*Math.round(t/e)}function Fe(t,e,n,i,r,s,o){if(e==n)return o;let a,l,h=Ae(t[e],r),u=Ae(t[e+1],r);e+=i,s[o++]=h,s[o++]=u;do{if(a=Ae(t[e],r),l=Ae(t[e+1],r),(e+=i)==n)return s[o++]=a,s[o++]=l,o}while(a==h&&l==u);for(;e<n;){const n=Ae(t[e],r),c=Ae(t[e+1],r);if(e+=i,n==a&&c==l)continue;const d=a-h,p=l-u,g=n-h,f=c-u;d*f==p*g&&(d<0&&g<d||d==g||d>0&&g>d)&&(p<0&&f<p||p==f||p>0&&f>p)?(a=n,l=c):(s[o++]=a,s[o++]=l,h=a,u=l,a=n,l=c)}return s[o++]=a,s[o++]=l,o}function De(t,e,n,i,r,s,o,a){for(let l=0,h=n.length;l<h;++l){const h=n[l];o=Fe(t,e,h,i,r,s,o),a.push(o),e=h}return o}function Ne(t,e,n,i,r){r=void 0!==r?r:[];let s=0;for(let o=e;o<n;o+=i)r[s++]=t.slice(o,o+i);return r.length=s,r}function Oe(t,e,n,i,r){r=void 0!==r?r:[];let s=0;for(let o=0,a=n.length;o<a;++o){const a=n[o];r[s++]=Ne(t,e,a,i,r[s]),e=a}return r.length=s,r}function ze(t,e,n,i){let r=0,s=t[n-i],o=t[n-i+1];for(;e<n;e+=i){const n=t[e],i=t[e+1];r+=o*n-s*i,s=n,o=i}return r/2}function Ge(t,e,n,i){let r=0;for(let s=0,o=n.length;s<o;++s){const o=n[s];r+=ze(t,e,o,i),e=o}return r}class je extends Ee{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new je(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,n,i){return i<v(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Re(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ie(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,i))}getArea(){return ze(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Ne(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=ke(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new je(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Te(this.flatCoordinates,0,t,this.stride),this.changed()}}const Ve=je;class Ke extends Ee{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new Ke(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,i){const r=this.flatCoordinates,s=Xt(t,e,r[0],r[1]);if(s<i){const t=this.stride;for(let e=0;e<t;++e)n[e]=r[e];return n.length=t,s}return i}getCoordinates(){return this.flatCoordinates?this.flatCoordinates.slice():[]}computeExtent(t){return function(t,e){const n=t[0],i=t[1];return b(n,i,n,i,e)}(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return _(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,n,i){for(let i=0,r=n.length;i<r;++i)t[e++]=n[i];return e}(this.flatCoordinates,0,t,this.stride),this.changed()}}const Ze=Ke;function qe(t,e,n,i,r){const s=function(t,e){let n;return n=e(function(t){return[t[0],t[1]]}(t)),n||(n=e(function(t){return[t[2],t[1]]}(t)),n||(n=e(function(t){return[t[2],t[3]]}(t)),n||(n=e(function(t){return[t[0],t[3]]}(t)),n||!1)))}(r,(function(r){return!Ue(t,e,n,i,r[0],r[1])}));return!s}function Ue(t,e,n,i,r,s){let o=0,a=t[n-i],l=t[n-i+1];for(;e<n;e+=i){const n=t[e],i=t[e+1];l<=s?i>s&&(n-a)*(s-l)-(r-a)*(i-l)>0&&o++:i<=s&&(n-a)*(s-l)-(r-a)*(i-l)<0&&o--,a=n,l=i}return 0!==o}function Be(t,e,n,i,r,s){if(0===n.length)return!1;if(!Ue(t,e,n[0],i,r,s))return!1;for(let e=1,o=n.length;e<o;++e)if(Ue(t,n[e-1],n[e],i,r,s))return!1;return!0}function Xe(t,e,n,i,r,s,o){let a,l,h,u,c,d,p;const g=r[s+1],f=[];for(let r=0,s=n.length;r<s;++r){const s=n[r];for(u=t[s-i],d=t[s-i+1],a=e;a<s;a+=i)c=t[a],p=t[a+1],(g<=d&&p<=g||d<=g&&g<=p)&&(h=(g-d)/(p-d)*(c-u)+u,f.push(h)),u=c,d=p}let m=NaN,v=-1/0;for(f.sort(at),u=f[0],a=1,l=f.length;a<l;++a){c=f[a];const r=Math.abs(c-u);r>v&&(h=(u+c)/2,Be(t,e,n,i,h,g)&&(m=h,v=r)),u=c}return isNaN(m)&&(m=r[s]),o?(o.push(m,g,v),o):[m,g,v]}function He(t,e,n,i,r){let s;for(e+=i;e<n;e+=i)if(s=r(t.slice(e-i,e),t.slice(e,e+i)),s)return s;return!1}function Ye(t,e,n,i,r){const s=P([1/0,1/0,-1/0,-1/0],t,e,n,i);return!!k(r,s)&&(!!y(r,s)||s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]||He(t,e,n,i,(function(t,e){return function(t,e,n){let i=!1;const r=x(t,e),s=x(t,n);if(r===m.INTERSECTING||s===m.INTERSECTING)i=!0;else{const o=t[0],a=t[1],l=t[2],h=t[3],u=e[0],c=e[1],d=n[0],p=n[1],g=(p-c)/(d-u);let f,v;s&m.ABOVE&&!(r&m.ABOVE)&&(f=d-(p-h)/g,i=f>=o&&f<=l),i||!(s&m.RIGHT)||r&m.RIGHT||(v=p-(d-l)*g,i=v>=a&&v<=h),i||!(s&m.BELOW)||r&m.BELOW||(f=d-(p-a)/g,i=f>=o&&f<=l),i||!(s&m.LEFT)||r&m.LEFT||(v=p-(d-o)*g,i=v>=a&&v<=h)}return i}(r,t,e)})))}function We(t,e,n,i,r){if(!function(t,e,n,i,r){return!!(Ye(t,e,n,i,r)||Ue(t,e,n,i,r[0],r[1])||Ue(t,e,n,i,r[0],r[3])||Ue(t,e,n,i,r[2],r[1])||Ue(t,e,n,i,r[2],r[3]))}(t,e,n[0],i,r))return!1;if(1===n.length)return!0;for(let e=1,s=n.length;e<s;++e)if(qe(t,n[e-1],n[e],i,r)&&!Ye(t,n[e-1],n[e],i,r))return!1;return!0}function Je(t,e,n,i){for(;e<n-i;){for(let r=0;r<i;++r){const s=t[e+r];t[e+r]=t[n-i+r],t[n-i+r]=s}e+=i,n-=i}}function $e(t,e,n,i){let r=0,s=t[n-i],o=t[n-i+1];for(;e<n;e+=i){const n=t[e],i=t[e+1];r+=(n-s)*(i+o),s=n,o=i}return 0===r?void 0:r>0}function Qe(t,e,n,i,r){r=void 0!==r&&r;for(let s=0,o=n.length;s<o;++s){const o=n[s],a=$e(t,e,o,i);if(0===s){if(r&&a||!r&&!a)return!1}else if(r&&!a||!r&&a)return!1;e=o}return!0}function tn(t,e,n,i,r){r=void 0!==r&&r;for(let s=0,o=n.length;s<o;++s){const o=n[s],a=$e(t,e,o,i);(0===s?r&&a||!r&&!a:r&&!a||!r&&a)&&Je(t,e,o,i),e=o}return e}function en(t,e,n,i,r){for(let s=0,o=n.length;s<o;++s)e=tn(t,e,n[s],i,r);return e}class nn extends Ee{constructor(t,e,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==e&&n?(this.setFlatCoordinates(e,t),this.ends_=n):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?ht(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new nn(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,i){return i<v(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Me(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Le(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,i))}containsXY(t,e){return Be(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Ge(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),tn(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,Oe(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=M(this.getExtent());this.flatInteriorPoint_=Xe(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Ze(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Ve(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,n=this.ends_,i=[];let r=0;for(let s=0,o=n.length;s<o;++s){const o=n[s],a=new Ve(e.slice(r,o),t);i.push(a),r=o}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Qe(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=tn(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=De(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new nn(e,"XY",n)}getType(){return"Polygon"}intersectsExtent(t){return We(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=Se(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()}}const rn=nn;function sn(t){const e=t[0],n=t[1],i=t[2],r=t[3],s=[e,n,e,r,i,r,i,n,e,n];return new nn(s,"XY",[s.length])}function on(t,e){setTimeout((function(){t(e)}),0)}function an(t){return!(t.sourceCenter&&t.targetCenter&&!F(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}function ln(t,e,n,i,r){const s=Math.cos(-r);let o=Math.sin(-r),a=t[0]*s-t[1]*o,l=t[1]*s+t[0]*o;return a+=(e[0]/2-n[0])*i,l+=(n[1]-e[1]/2)*i,o=-o,[a*s-l*o,l*s+a*o]}const hn=class extends At{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=U(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&function(t){G=!(void 0===t||t)}(),t.center&&(t.center=Q(t.center,this.projection_)),t.extent&&(t.extent=tt(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(e){const n=Object.assign({},e);for(const t in ue)delete n[t];this.setProperties(n,!0);const i=function(e){let n,i,r;let s=void 0!==e.minZoom?e.minZoom:0,o=void 0!==e.maxZoom?e.maxZoom:28;const a=void 0!==e.zoomFactor?e.zoomFactor:2,l=void 0!==e.multiWorld&&e.multiWorld,h=void 0===e.smoothResolutionConstraint||e.smoothResolutionConstraint,u=void 0!==e.showFullExtent&&e.showFullExtent,c=U(e.projection,"EPSG:3857"),d=c.getExtent();let p=e.constrainOnlyCenter,g=e.extent;if(l||g||!c.isGlobal()||(p=!1,g=d),void 0!==e.resolutions){const t=e.resolutions;i=t[s],r=void 0!==t[o]?t[o]:t[t.length-1],n=e.constrainResolution?function(t,e,n,i){return e=void 0===e||e,function(r,s,o,a){if(void 0!==r){const l=t[0],h=t[t.length-1],u=n?pe(l,n,o,i):l;if(a)return e?ge(r,u,h):Ut(r,h,u);const c=Math.min(u,r),d=Math.floor(lt(t,c,s));return t[d]>u&&d<t.length-1?t[d+1]:t[d]}}}(t,h,!p&&g,u):fe(i,r,h,!p&&g,u)}else{const l=(d?Math.max(S(d),L(d)):360*t.degrees/c.getMetersPerUnit())/256/Math.pow(2,0),f=l/Math.pow(2,28);i=e.maxResolution,void 0!==i?s=0:i=l/Math.pow(a,s),r=e.minResolution,void 0===r&&(r=void 0!==e.maxZoom?void 0!==e.maxResolution?i/Math.pow(a,o):l/Math.pow(a,o):f),o=s+Math.floor(Math.log(i/r)/Math.log(a)),r=i/Math.pow(a,o-s),n=e.constrainResolution?function(t,e,n,i,r,s){return i=void 0===i||i,n=void 0!==n?n:0,function(o,a,l,h){if(void 0!==o){const u=r?pe(e,r,l,s):e;if(h)return i?ge(o,u,n):Ut(o,n,u);const c=1e-9,d=Math.ceil(Math.log(e/u)/Math.log(t)-c),p=-a*(.5-c)+.5,g=Math.min(u,o),f=Math.floor(Math.log(e/g)/Math.log(t)+p),m=Math.max(d,f);return Ut(e/Math.pow(t,m),n,u)}}}(a,i,r,h,!p&&g,u):fe(i,r,h,!p&&g,u)}return{constraint:n,maxResolution:i,minResolution:r,minZoom:s,zoomFactor:a}}(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=function(t){if(void 0!==t.extent){const e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return ce(t.extent,t.constrainOnlyCenter,e)}const e=U(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,ce(t,!1,!1)}return de}(e),s=i.constraint,o=function(t){if(void 0===t.enableRotation||t.enableRotation){const n=t.constrainRotation;return void 0===n||!0===n?(e=e||5*Math.PI/180,function(t,n){return n?t:void 0!==t?Math.abs(t)<=e?0:t:void 0}):!1===n?ve:"number"==typeof n?function(t){const e=2*Math.PI/t;return function(t,n){return n?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}(n):ve}var e;return me}(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(void 0!==e.rotation?e.rotation:0),this.setCenterInternal(void 0!==e.center?e.center:null),void 0!==e.resolution?this.setResolution(e.resolution):void 0!==e.zoom&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const n=this.getCenterInternal();if(n){const i=t||[0,0,0,0];e=e||[0,0,0,0];const r=this.getResolution(),s=r/2*(i[3]-e[3]+e[1]-i[1]),o=r/2*(i[0]-e[0]+e[2]-i[2]);this.setCenterInternal([n[0]+s,n[1]-o])}}getUpdatedOptions_(t){const e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let t=0;t<e.length;++t){let n=arguments[t];n.center&&(n=Object.assign({},n),n.center=Q(n.center,this.getProjection())),n.anchor&&(n=Object.assign({},n),n.anchor=Q(n.anchor,this.getProjection())),e[t]=n}this.animateInternal.apply(this,e)}animateInternal(t){let e,n=arguments.length;n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n);let i=0;for(;i<n&&!this.isDef();++i){const t=arguments[i];t.center&&this.setCenterInternal(t.center),void 0!==t.zoom?this.setZoom(t.zoom):t.resolution&&this.setResolution(t.resolution),void 0!==t.rotation&&this.setRotation(t.rotation)}if(i===n)return void(e&&on(e,!0));let r=Date.now(),s=this.targetCenter_.slice(),o=this.targetResolution_,a=this.targetRotation_;const l=[];for(;i<n;++i){const t=arguments[i],n={start:r,complete:!1,anchor:t.anchor,duration:void 0!==t.duration?t.duration:1e3,easing:t.easing||_e,callback:e};if(t.center&&(n.sourceCenter=s,n.targetCenter=t.center.slice(),s=n.targetCenter),void 0!==t.zoom?(n.sourceResolution=o,n.targetResolution=this.getResolutionForZoom(t.zoom),o=n.targetResolution):t.resolution&&(n.sourceResolution=o,n.targetResolution=t.resolution,o=n.targetResolution),void 0!==t.rotation){n.sourceRotation=a;const e=Ht(t.rotation-a+Math.PI,2*Math.PI)-Math.PI;n.targetRotation=a+e,a=n.targetRotation}an(n)?n.complete=!0:r+=n.duration,l.push(n)}this.animations_.push(l),this.setHint(0,1),this.updateAnimations_()}getAnimating(){return this.hints_[0]>0}getInteracting(){return this.hints_[1]>0}cancelAnimations(){let t;this.setHint(0,-this.hints_[0]);for(let e=0,n=this.animations_.length;e<n;++e){const n=this.animations_[e];if(n[0].callback&&on(n[0].callback,!1),!t)for(let e=0,i=n.length;e<i;++e){const i=n[e];if(!i.complete){t=i.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let n=this.animations_.length-1;n>=0;--n){const i=this.animations_[n];let r=!0;for(let n=0,s=i.length;n<s;++n){const s=i[n];if(s.complete)continue;const o=t-s.start;let a=s.duration>0?o/s.duration:1;a>=1?(s.complete=!0,a=1):r=!1;const l=s.easing(a);if(s.sourceCenter){const t=s.sourceCenter[0],e=s.sourceCenter[1],n=s.targetCenter[0],i=s.targetCenter[1];this.nextCenter_=s.targetCenter;const r=t+l*(n-t),o=e+l*(i-e);this.targetCenter_=[r,o]}if(s.sourceResolution&&s.targetResolution){const t=1===l?s.targetResolution:s.sourceResolution+l*(s.targetResolution-s.sourceResolution);if(s.anchor){const e=this.getViewportSize_(this.getRotation()),n=this.constraints_.resolution(t,0,e,!0);this.targetCenter_=this.calculateCenterZoom(n,s.anchor)}this.nextResolution_=s.targetResolution,this.targetResolution_=t,this.applyTargetState_(!0)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){const t=1===l?Ht(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+l*(s.targetRotation-s.sourceRotation);if(s.anchor){const e=this.constraints_.rotation(t,!0);this.targetCenter_=this.calculateCenterRotate(e,s.anchor)}this.nextRotation_=s.targetRotation,this.targetRotation_=t}if(this.applyTargetState_(!0),e=!0,!s.complete)break}if(r){this.animations_[n]=null,this.setHint(0,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const t=i[0].callback;t&&on(t,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let n;const i=this.getCenterInternal();var r,s;return void 0!==i&&(n=[i[0]-e[0],i[1]-e[1]],D(n,t-this.getRotation()),s=e,(r=n)[0]+=+s[0],r[1]+=+s[1]),n}calculateCenterZoom(t,e){let n;const i=this.getCenterInternal(),r=this.getResolution();return void 0!==i&&void 0!==r&&(n=[e[0]-t*(e[0]-i[0])/r,e[1]-t*(e[1]-i[1])/r]),n}getViewportSize_(t){const e=this.viewportSize_;if(t){const n=e[0],i=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(i*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(i*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t?$(t,this.getProjection()):t}getCenterInternal(){return this.get(ue.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){return e=this.calculateExtentInternal(t),n=this.getProjection(),W?Y(e,n,W):e;var e,n}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();Kt(e,1);const n=this.getResolution();Kt(void 0!==n,2);const i=this.getRotation();return Kt(void 0!==i,3),I(e,n,i,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(ue.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(tt(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const n=S(t)/e[0],i=L(t)/e[1];return Math.max(n,i)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,i=Math.log(e/n)/Math.log(t);return function(n){return e/Math.pow(t,n*i)}}getRotation(){return this.get(ue.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(n/i)/e;return function(t){return Math.log(n/t)/e/r}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),n=this.getRotation();let i=this.getCenterInternal();const r=this.padding_;if(r){const t=this.getViewportSizeMinusPadding_();i=ln(i,this.getViewportSize_(),[t[0]/2+r[3],t[1]/2+r[0]],e,n)}return{center:i.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e,n,i=this.minZoom_||0;if(this.resolutions_){const r=lt(this.resolutions_,t,1);i=r,e=this.resolutions_[r],n=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,n=this.zoomFactor_;return i+Math.log(e/t)/Math.log(n)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=Ut(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,Ut(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let n;if(Kt(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t))Kt(!A(t),25),n=sn(tt(t,this.getProjection()));else if("Circle"===t.getType()){const e=tt(t.getExtent(),this.getProjection());n=sn(e),n.rotate(this.getRotation(),M(e))}else{const e=J();n=e?t.clone().transform(e,this.getProjection()):t}this.fitInternal(n,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),n=Math.cos(e),i=Math.sin(-e),r=t.getFlatCoordinates(),s=t.getStride();let o=1/0,a=1/0,l=-1/0,h=-1/0;for(let t=0,e=r.length;t<e;t+=s){const e=r[t]*n-r[t+1]*i,s=r[t]*i+r[t+1]*n;o=Math.min(o,e),a=Math.min(a,s),l=Math.max(l,e),h=Math.max(h,s)}return[o,a,l,h]}fitInternal(t,e){let n=(e=e||{}).size;n||(n=this.getViewportSizeMinusPadding_());const i=void 0!==e.padding?e.padding:[0,0,0,0],r=void 0!==e.nearest&&e.nearest;let s;s=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;const o=this.rotatedExtentForGeometry(t);let a=this.getResolutionForExtentInternal(o,[n[0]-i[1]-i[3],n[1]-i[0]-i[2]]);a=isNaN(a)?s:Math.max(a,s),a=this.getConstrainedResolution(a,r?0:1);const l=this.getRotation(),h=Math.sin(l),u=Math.cos(l),c=M(o);c[0]+=(i[1]-i[3])/2*a,c[1]+=(i[0]-i[2])/2*a;const d=c[0]*u-c[1]*h,p=c[1]*u+c[0]*h,g=this.getConstrainedCenter([d,p],a),f=e.callback?e.callback:pt;void 0!==e.duration?this.animateInternal({resolution:a,center:g,duration:e.duration,easing:e.easing},f):(this.targetResolution_=a,this.targetCenter_=g,this.applyTargetState_(!1,!0),on(f,!0))}centerOn(t,e,n){this.centerOnInternal(Q(t,this.getProjection()),e,n)}centerOnInternal(t,e,n){this.setCenterInternal(ln(t,e,n,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,n,i){let r;const s=this.padding_;if(s&&t){const o=this.getViewportSizeMinusPadding_(-n),a=ln(t,i,[o[0]/2+s[3],o[1]/2+s[0]],e,n);r=[t[0]-a[0],t[1]-a[1]]}return r}isDef(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}adjustCenter(t){const e=$(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Q(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const n=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,i,n);e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Q(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const n=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(i,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t?Q(t,this.getProjection()):t)}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const n=this.getAnimating()||this.getInteracting()||e,i=this.constraints_.rotation(this.targetRotation_,n),r=this.getViewportSize_(i),s=this.constraints_.resolution(this.targetResolution_,0,r,n),o=this.constraints_.center(this.targetCenter_,s,r,n,this.calculateCenterShift(this.targetCenter_,s,i,r));this.get(ue.ROTATION)!==i&&this.set(ue.ROTATION,i),this.get(ue.RESOLUTION)!==s&&(this.set(ue.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),o&&this.get(ue.CENTER)&&F(this.get(ue.CENTER),o)||this.set(ue.CENTER,o),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,n){t=void 0!==t?t:200;const i=e||0,r=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,i,s),a=this.constraints_.center(this.targetCenter_,o,s,!1,this.calculateCenterShift(this.targetCenter_,o,r,s));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=o,this.targetRotation_=r,this.targetCenter_=a,void this.applyTargetState_();n=n||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===o&&this.getRotation()===r&&this.getCenterInternal()&&F(this.getCenterInternal(),a)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:a,resolution:o,duration:t,easing:ye,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(1,1)}endInteraction(t,e,n){n=n&&Q(n,this.getProjection()),this.endInteractionInternal(t,e,n)}endInteractionInternal(t,e,n){this.getInteracting()&&(this.setHint(1,-1),this.resolveConstraints(t,e,n))}getConstrainedCenter(t,e){const n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}getConstrainedZoom(t,e){const n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}getConstrainedResolution(t,e){e=e||0;const n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}};function un(t,e){if(!t.visible)return!1;const n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;const i=e.zoom;return i>t.minZoom&&i<=t.maxZoom}const cn=class extends ae{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(oe,this.handleSourcePropertyChange_);const n=t.source?t.source:null;this.setSource(n)}getLayersArray(t){return(t=t||[]).push(this),t}getLayerStatesArray(t){return(t=t||[]).push(this.getLayerState()),t}getSource(){return this.get(oe)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Rt(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=Et(t,vt,this.handleSourceChange_,this),"ready"===t.getState()&&(this.sourceReady_=!0,setTimeout((()=>{this.dispatchEvent("sourceready")}),0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}isVisible(t){let e;e=t instanceof hn?{viewState:t.getState(),extent:t.calculateExtent()}:t;const n=this.getExtent();return this.getVisible()&&un(this.getLayerState(),e.viewState)&&(!n||k(n,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e;const n=this.getSource();if(n&&(e=n.getAttributions()),!e)return[];let i=e(t instanceof hn?t.getViewStateAndExtent():t);return Array.isArray(i)||(i=[i]),i}render(t,e){const n=this.getRenderer();if(n.prepareFrame(t))return this.rendered=!0,n.renderFrame(t,e)}unrender(){this.rendered=!1}setMapInternal(t){t||this.unrender(),this.set("map",t)}getMapInternal(){return this.get("map")}setMap(t){this.mapPrecomposeKey_&&(Rt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Rt(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Et(t,le,(function(t){const e=t.frameState.layerStatesArray,n=this.getLayerState(!1);Kt(!e.some((function(t){return t.layer===n.layer})),67),e.push(n)}),this),this.mapRenderKey_=Et(this,vt,t.render,t),this.changed())}setSource(t){this.set(oe,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}};function dn(t,e){Jt.expire()}const pn=class extends ot{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){Lt()}calculateMatrices2D(t){const e=t.viewState,n=t.coordinateToPixelTransform,i=t.pixelToCoordinateTransform;qt(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),function(t,e){const n=(i=e)[0]*i[3]-i[1]*i[2];var i;Kt(0!==n,32);const r=e[0],s=e[1],o=e[2],a=e[3],l=e[4],h=e[5];t[0]=a/n,t[1]=-s/n,t[2]=-o/n,t[3]=r/n,t[4]=(o*h-a*l)/n,t[5]=-(r*h-s*l)/n}(i,n)}forEachFeatureAtCoordinate(t,e,n,i,r,s,o,a){let l;const h=e.viewState;function u(t,e,n,i){return r.call(s,e,t?n:null,i)}const c=h.projection,d=function(t,e){if(e.canWrapX()){const n=S(e.getExtent()),i=function(t,e,n){const i=e.getExtent();let r=0;return e.canWrapX()&&(t[0]<i[0]||t[0]>i[2])&&(n=n||S(i),r=Math.floor((t[0]-i[0])/n)),r}(t,e,n);i&&(t[0]-=i*n)}return t}(t.slice(),c),p=[[0,0]];if(c.canWrapX()&&i){const t=S(c.getExtent());p.push([-t,0],[t,0])}const g=e.layerStatesArray,f=g.length,m=[],v=[];for(let i=0;i<p.length;i++)for(let r=f-1;r>=0;--r){const s=g[r],c=s.layer;if(c.hasRenderer()&&un(s,h)&&o.call(a,c)){const r=c.getRenderer(),o=c.getSource();if(r&&o){const a=o.getWrapX()?d:t,h=u.bind(null,s.managed);v[0]=a[0]+p[i][0],v[1]=a[1]+p[i][1],l=r.forEachFeatureAtCoordinate(v,e,n,h,m)}if(l)return l}}if(0===m.length)return;const y=1/m.length;return m.forEach(((t,e)=>t.distanceSq+=e*y)),m.sort(((t,e)=>t.distanceSq-e.distanceSq)),m.some((t=>l=t.callback(t.feature,t.layer,t.geometry))),l}hasFeatureAtCoordinate(t,e,n,i,r,s){return void 0!==this.forEachFeatureAtCoordinate(t,e,n,i,ct,this,r,s)}getMap(){return this.map_}renderFrame(t){Lt()}scheduleExpireIconCache(t){Jt.canExpireCache()&&t.postRenderFunctions.push(dn)}},gn=class extends rt{constructor(t,e,n,i){super(t),this.inversePixelTransform=e,this.frameState=n,this.context=i}},fn="ol-hidden",mn="ol-unselectable",vn="ol-control",yn="ol-collapsed",_n=(new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),"undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():""),xn=_n.includes("firefox"),bn=(_n.includes("safari")&&!_n.includes("chrom")&&(_n.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(_n)),_n.includes("webkit")&&!_n.includes("edge")),Cn=_n.includes("macintosh"),wn="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,En=("undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&(self,WorkerGlobalScope),"undefined"!=typeof Image&&Image.prototype.decode,function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}());function Pn(t){let e=t.offsetWidth;const n=getComputedStyle(t);return e+=parseInt(n.marginLeft,10)+parseInt(n.marginRight,10),e}function Rn(t){let e=t.offsetHeight;const n=getComputedStyle(t);return e+=parseInt(n.marginTop,10)+parseInt(n.marginBottom,10),e}function Mn(t,e){const n=e.parentNode;n&&n.replaceChild(t,e)}function In(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function Ln(t){for(;t.lastChild;)t.removeChild(t.lastChild)}const Tn=new At;!function(){const t=["monospace","serif"];t.length}();const Sn=class extends pn{constructor(t){super(t),this.fontChangeListenerKey_=Et(Tn,st,t.redrawText.bind(t)),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=mn+" ol-layers";const n=t.getViewport();n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const n=this.getMap();if(n.hasListener(t)){const i=new gn(t,void 0,e);n.dispatchEvent(i)}}disposeInternal(){Rt(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));this.calculateMatrices2D(t),this.dispatchRenderEvent(le,t);const e=t.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex})),n=t.viewState;this.children_.length=0;const i=[];let r=null;for(let s=0,o=e.length;s<o;++s){const o=e[s];t.layerIndex=s;const a=o.layer,l=a.getSourceState();if(!un(o,n)||"ready"!=l&&"undefined"!=l){a.unrender();continue}const h=a.render(t,r);h&&(h!==r&&(this.children_.push(h),r=h),"getDeclutter"in a&&i.push(a))}for(let e=i.length-1;e>=0;--e)i[e].renderDeclutter(t);!function(t,e){const n=t.childNodes;for(let i=0;;++i){const r=n[i],s=e[i];if(!r&&!s)break;r!==s&&(r?s?t.insertBefore(s,r):(t.removeChild(r),--i):t.appendChild(s))}}(this.element_,this.children_),this.dispatchRenderEvent("postcompose",t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}};class kn extends rt{constructor(t,e){super(t),this.layer=e}}const An="layers";class Fn extends ae{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let n=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(An,this.handleLayersChanged_),n?Array.isArray(n)?n=new Vt(n.slice(),{unique:!0}):Kt("function"==typeof n.getArray,43):n=new Vt(void 0,{unique:!0}),this.setLayers(n)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Rt),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(Et(t,Ot,this.handleLayersAdd_,this),Et(t,zt,this.handleLayersRemove_,this));for(const t in this.listenerKeys_)this.listenerKeys_[t].forEach(Rt);gt(this.listenerKeys_);const e=t.getArray();for(let t=0,n=e.length;t<n;t++){const n=e[t];this.registerLayerListeners_(n),this.dispatchEvent(new kn("addlayer",n))}this.changed()}registerLayerListeners_(t){const e=[Et(t,st,this.handleLayerChange_,this),Et(t,vt,this.handleLayerChange_,this)];t instanceof Fn&&e.push(Et(t,"addlayer",this.handleLayerGroupAdd_,this),Et(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[St(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new kn("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new kn("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new kn("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,n=St(e);this.listenerKeys_[n].forEach(Rt),delete this.listenerKeys_[n],this.dispatchEvent(new kn("removelayer",e)),this.changed()}getLayers(){return this.get(An)}setLayers(t){const e=this.getLayers();if(e){const t=e.getArray();for(let e=0,n=t.length;e<n;++e)this.dispatchEvent(new kn("removelayer",t[e]))}this.set(An,t)}getLayersArray(t){return t=void 0!==t?t:[],this.getLayers().forEach((function(e){e.getLayersArray(t)})),t}getLayerStatesArray(t){const e=void 0!==t?t:[],n=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));const i=this.getLayerState();let r=i.zIndex;t||void 0!==i.zIndex||(r=0);for(let t=n,s=e.length;t<s;t++){const n=e[t];n.opacity*=i.opacity,n.visible=n.visible&&i.visible,n.maxResolution=Math.min(n.maxResolution,i.maxResolution),n.minResolution=Math.max(n.minResolution,i.minResolution),n.minZoom=Math.max(n.minZoom,i.minZoom),n.maxZoom=Math.min(n.maxZoom,i.maxZoom),void 0!==i.extent&&(void 0!==n.extent?n.extent=T(n.extent,i.extent):n.extent=i.extent),void 0===n.zIndex&&(n.zIndex=r)}return e}getSourceState(){return"ready"}}const Dn=Fn,Nn=class extends rt{constructor(t,e,n){super(t),this.map=e,this.frameState=void 0!==n?n:null}},On=class extends Nn{constructor(t,e,n,i,r,s){super(t,e,r),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==i&&i,this.activePointers=s}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},zn={SINGLECLICK:"singleclick",CLICK:_t,DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Gn="pointerdown",jn=class extends mt{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=void 0===e?1:e,this.down_=null;const n=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=n,this.pointerdownListenerKey_=Et(n,Gn,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=Et(n,"pointermove",this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Ct,this.boundHandleTouchMove_,!!En&&{passive:!1})}emulateClick_(t){let e=new On(zn.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new On(zn.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout((()=>{this.clickTimeoutId_=void 0;const e=new On(zn.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}),250)}updateActivePointers_(t){const e=t,n=e.pointerId;if(e.type==zn.POINTERUP||e.type==zn.POINTERCANCEL){delete this.trackedTouches_[n];for(const t in this.trackedTouches_)if(this.trackedTouches_[t].target!==e.target){delete this.trackedTouches_[t];break}}else e.type!=zn.POINTERDOWN&&e.type!=zn.POINTERMOVE||(this.trackedTouches_[n]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new On(zn.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(Rt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return 0===t.button}handlePointerDown_(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);const e=new On(zn.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),0===this.dragListenerKeys_.length){const t=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Et(t,zn.POINTERMOVE,this.handlePointerMove_,this),Et(t,zn.POINTERUP,this.handlePointerUp_,this),Et(this.element_,zn.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==t&&this.dragListenerKeys_.push(Et(this.element_.getRootNode(),zn.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new On(zn.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new On(zn.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Rt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Ct,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Rt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Rt),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},Vn="postrender",Kn="loadstart",Zn="loadend",qn="layergroup",Un="size",Bn="target",Xn="view",Hn=1/0,Yn=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,gt(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,n=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const i=this.keyFunction_(n);return delete this.queuedElements_[i],n}enqueue(t){Kt(!(this.keyFunction_(t)in this.queuedElements_),31);const e=this.priorityFunction_(t);return e!=Hn&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(t){return 2*t+1}getRightChildIndex_(t){return 2*t+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return 0===this.elements_.length}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,n=this.priorities_,i=e.length,r=e[t],s=n[t],o=t;for(;t<i>>1;){const r=this.getLeftChildIndex_(t),s=this.getRightChildIndex_(t),o=s<i&&n[s]<n[r]?s:r;e[t]=e[o],n[t]=n[o],t=o}e[t]=r,n[t]=s,this.siftDown_(o,t)}siftDown_(t,e){const n=this.elements_,i=this.priorities_,r=n[e],s=i[e];for(;e>t;){const t=this.getParentIndex_(e);if(!(i[t]>s))break;n[e]=n[t],i[e]=i[t],e=t}n[e]=r,i[e]=s}reprioritize(){const t=this.priorityFunction_,e=this.elements_,n=this.priorities_;let i=0;const r=e.length;let s,o,a;for(o=0;o<r;++o)s=e[o],a=t(s),a==Hn?delete this.queuedElements_[this.keyFunction_(s)]:(n[i]=a,e[i++]=s);e.length=i,n.length=i,this.heapify_()}},Wn=class extends Yn{constructor(t,e){super((function(e){return t.apply(null,e)}),(function(t){return t[0].getKey()})),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(vt,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,n=e.getState();if(2===n||3===n||4===n){3!==n&&e.removeEventListener(vt,this.boundHandleTileChange_);const t=e.getKey();t in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[t],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let n,i,r,s=0;for(;this.tilesLoading_<t&&s<e&&this.getCount()>0;)i=this.dequeue()[0],r=i.getKey(),n=i.getState(),0!==n||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++s,i.load())}},Jn=class extends At{constructor(t){super();const e=t.element;!e||t.target||e.style.pointerEvents||(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){In(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&In(this.element);for(let t=0,e=this.listenerKeys.length;t<e;++t)Rt(this.listenerKeys[t]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==pt&&this.listenerKeys.push(Et(t,Vn,this.render,this)),t.render())}render(t){}setTarget(t){this.target_="string"==typeof t?document.getElementById(t):t}},$n=class extends Jn{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==t.collapsible,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1);const e=void 0!==t.className?t.className:"ol-attribution",n=void 0!==t.tipLabel?t.tipLabel:"Attributions",i=void 0!==t.expandClassName?t.expandClassName:e+"-expand",r=void 0!==t.collapseLabel?t.collapseLabel:"›",s=void 0!==t.collapseClassName?t.collapseClassName:e+"-collapse";"string"==typeof r?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r,this.collapseLabel_.className=s):this.collapseLabel_=r;const o=void 0!==t.label?t.label:"i";"string"==typeof o?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=i):this.label_=o;const a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=n,this.toggleButton_.appendChild(a),this.toggleButton_.addEventListener(_t,this.handleClick_.bind(this),!1);const l=e+" "+mn+" "+vn+(this.collapsed_&&this.collapsible_?" "+yn:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=l,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=Array.from(new Set(this.getMap().getAllLayers().flatMap((e=>e.getAttributions(t))))),n=!this.getMap().getAllLayers().some((t=>t.getSource()&&!1===t.getSource().getAttributionsCollapsible()));return this.overrideCollapsible_||this.setCollapsible(n),e}updateElement_(t){if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=this.collectSourceAttributions_(t),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!ut(e,this.renderedAttributions_)){Ln(this.ulElement_);for(let t=0,n=e.length;t<n;++t){const n=document.createElement("li");n.innerHTML=e[t],this.ulElement_.appendChild(n)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(yn),this.collapsed_?Mn(this.collapseLabel_,this.label_):Mn(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}},Qn=class extends Jn{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=void 0!==t.className?t.className:"ol-rotate",n=void 0!==t.label?t.label:"⇧",i=void 0!==t.compassClassName?t.compassClassName:"ol-compass";this.label_=null,"string"==typeof n?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(i));const r=t.tipLabel?t.tipLabel:"Reset rotation",s=document.createElement("button");s.className=e+"-reset",s.setAttribute("type","button"),s.title=r,s.appendChild(this.label_),s.addEventListener(_t,this.handleClick_.bind(this),!1);const o=e+" "+mn+" "+vn,a=this.element;a.className=o,a.appendChild(s),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=void 0!==t.duration?t.duration:250,this.autoHide_=void 0===t.autoHide||t.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(fn)}handleClick_(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:ye}):t.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const n=e.viewState.rotation;if(n!=this.rotation_){const t="rotate("+n+"rad)";if(this.autoHide_){const t=this.element.classList.contains(fn);t||0!==n?t&&0!==n&&this.element.classList.remove(fn):this.element.classList.add(fn)}this.label_.style.transform=t}this.rotation_=n}},ti=class extends Jn{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=void 0!==t.className?t.className:"ol-zoom",n=void 0!==t.delta?t.delta:1,i=void 0!==t.zoomInClassName?t.zoomInClassName:e+"-in",r=void 0!==t.zoomOutClassName?t.zoomOutClassName:e+"-out",s=void 0!==t.zoomInLabel?t.zoomInLabel:"+",o=void 0!==t.zoomOutLabel?t.zoomOutLabel:"–",a=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",l=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=i,h.setAttribute("type","button"),h.title=a,h.appendChild("string"==typeof s?document.createTextNode(s):s),h.addEventListener(_t,this.handleClick_.bind(this,n),!1);const u=document.createElement("button");u.className=r,u.setAttribute("type","button"),u.title=l,u.appendChild("string"==typeof o?document.createTextNode(o):o),u.addEventListener(_t,this.handleClick_.bind(this,-n),!1);const c=e+" "+mn+" "+vn,d=this.element;d.className=c,d.appendChild(h),d.appendChild(u),this.duration_=void 0!==t.duration?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const e=this.getMap().getView();if(!e)return;const n=e.getZoom();if(void 0!==n){const i=e.getConstrainedZoom(n+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:i,duration:this.duration_,easing:ye})):e.setZoom(i)}}},ei="active";function ni(t,e,n,i){const r=t.getZoom();if(void 0===r)return;const s=t.getConstrainedZoom(r+e),o=t.getResolutionForZoom(s);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:o,anchor:n,duration:void 0!==i?i:250,easing:ye})}const ii=class extends At{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(ei)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(ei,t)}setMap(t){this.map_=t}},ri=class extends ii{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:250}handleEvent(t){let e=!1;if(t.type==zn.DBLCLICK){const n=t.originalEvent,i=t.map,r=t.coordinate,s=n.shiftKey?-this.delta_:this.delta_;ni(i.getView(),s,r,this.duration_),n.preventDefault(),e=!0}return!e}};function si(t){const e=t.length;let n=0,i=0;for(let r=0;r<e;r++)n+=t[r].clientX,i+=t[r].clientY;return{clientX:n/e,clientY:i/e}}const oi=class extends ii{constructor(t){super(t=t||{}),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==zn.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==zn.POINTERUP){const e=this.handleUpEvent(t);this.handlingDownUpSequence=e&&this.targetPointers.length>0}}else if(t.type==zn.POINTERDOWN){const n=this.handleDownEvent(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==zn.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function ai(t){const e=arguments;return function(t){let n=!0;for(let i=0,r=e.length;i<r&&(n=n&&e[i](t),n);++i);return n}}const li=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},hi=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},ui=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||function(t){const e=t.map.getTargetElement(),n=t.map.getOwnerDocument().activeElement;return e.contains(n)}(t)},ci=ct,di=function(t){const e=t.originalEvent;return 0==e.button&&!(bn&&Cn&&e.ctrlKey)},pi=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},gi=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},fi=function(t){const e=t.originalEvent,n=e.target.tagName;return"INPUT"!==n&&"SELECT"!==n&&"TEXTAREA"!==n&&!e.target.isContentEditable},mi=function(t){const e=t.originalEvent;return Kt(void 0!==e,56),"mouse"==e.pointerType},vi=function(t){const e=t.originalEvent;return Kt(void 0!==e,56),e.isPrimary&&0===e.button},yi=class extends oi{constructor(t){super({stopDown:dt}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:ai(pi,vi);this.condition_=t.onFocusOnly?ai(ui,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const n=this.targetPointers,i=e.getEventPixel(si(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const e=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],n=t.map.getView();r=e,s=n.getResolution(),r[0]*=s,r[1]*=s,D(e,n.getRotation()),n.adjustCenterInternal(e)}}else this.kinetic_&&this.kinetic_.begin();var r,s;this.lastCentroid=i,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),i=this.kinetic_.getAngle(),r=n.getCenterInternal(),s=e.getPixelFromCoordinateInternal(r),o=e.getCoordinateFromPixelInternal([s[0]-t*Math.cos(i),s[1]-t*Math.sin(i)]);n.animateInternal({center:n.getConstrainedCenter(o),duration:500,easing:ye})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},_i=class extends oi{constructor(t){t=t||{},super({stopDown:dt}),this.condition_=t.condition?t.condition:hi,this.lastAngle_=void 0,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){if(!mi(t))return;const e=t.map,n=e.getView();if(n.getConstraints().rotation===me)return;const i=e.getSize(),r=t.pixel,s=Math.atan2(i[1]/2-r[1],r[0]-i[0]/2);if(void 0!==this.lastAngle_){const t=s-this.lastAngle_;n.adjustRotationInternal(-t)}this.lastAngle_=s}handleUpEvent(t){return!mi(t)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){return!!mi(t)&&(!(!di(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))}},xi=class extends ot{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,n="px",i=this.element_.style;i.left=Math.min(t[0],e[0])+n,i.top=Math.min(t[1],e[1])+n,i.width=Math.abs(e[0]-t[0])+n,i.height=Math.abs(e[1]-t[1])+n}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,n=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new rn([n])}getGeometry(){return this.geometry_}};class bi extends rt{constructor(t,e,n){super(t),this.coordinate=e,this.mapBrowserEvent=n}}const Ci=class extends oi{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.box_=new xi(t.className||"ol-dragbox"),this.minArea_=void 0!==t.minArea?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:di,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,n){const i=n[0]-e[0],r=n[1]-e[1];return i*i+r*r>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new bi("boxdrag",t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new bi(e?"boxend":"boxcancel",t.coordinate,t)),!1}handleDownEvent(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new bi("boxstart",t.coordinate,t)),!0)}onBoxEnd(t){}},wi=class extends Ci{constructor(t){super({condition:(t=t||{}).condition?t.condition:gi,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=void 0!==t.duration?t.duration:200,this.out_=void 0!==t.out&&t.out}onBoxEnd(t){const e=this.getMap().getView();let n=this.getGeometry();if(this.out_){const t=e.rotatedExtentForGeometry(n),i=e.getResolutionForExtentInternal(t),r=e.getResolution()/i;n=n.clone(),n.scale(r*r)}e.fitInternal(n,{duration:this.duration_,easing:ye})}},Ei=class extends ii{constructor(t){super(),t=t||{},this.defaultCondition_=function(t){return pi(t)&&fi(t)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==xt){const n=t.originalEvent,i=n.keyCode;if(this.condition_(t)&&(40==i||37==i||39==i||38==i)){const r=t.map.getView(),s=r.getResolution()*this.pixelDelta_;let o=0,a=0;40==i?a=-s:37==i?o=-s:39==i?o=s:a=s;const l=[o,a];D(l,r.getRotation()),function(t,e,n){const i=t.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];t.animateInternal({duration:void 0!==n?n:250,easing:xe,center:t.getConstrainedCenter(r)})}}(r,l,this.duration_),n.preventDefault(),e=!0}}return!e}},Pi=class extends ii{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:fi,this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:100}handleEvent(t){let e=!1;if(t.type==xt||t.type==bt){const n=t.originalEvent,i=n.key;if(this.condition_(t)&&("+"===i||"-"===i)){const r=t.map,s="+"===i?this.delta_:-this.delta_;ni(r.getView(),s,void 0,this.duration_),n.preventDefault(),e=!0}}return!e}},Ri=class extends ii{constructor(t){super(t=t||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,this.duration_=void 0!==t.duration?t.duration:250,this.timeout_=void 0!==t.timeout?t.timeout:80,this.useAnchor_=void 0===t.useAnchor||t.useAnchor,this.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;const e=t.condition?t.condition:ci;this.condition_=t.onFocusOnly?ai(ui,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t))return!0;if(t.type!==wt)return!0;const e=t.map,n=t.originalEvent;let i;if(n.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==wt&&(i=n.deltaY,xn&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(i/=wn),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(i*=40)),0===i)return!1;this.lastDelta_=i;const r=Date.now();void 0===this.startTime_&&(this.startTime_=r),(!this.mode_||r-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(i)<4?"trackpad":"wheel");const s=e.getView();if("trackpad"===this.mode_&&!s.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(s.getAnimating()&&s.cancelAnimations(),s.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),s.adjustZoom(-i/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=r,!1;this.totalDelta_+=i;const o=Math.max(this.timeout_-(r-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,e),o),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let n=-Ut(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),ni(e,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}},Mi=class extends oi{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=dt),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==t.threshold?t.threshold:.3,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){let e=0;const n=this.targetPointers[0],i=this.targetPointers[1],r=Math.atan2(i.clientY-n.clientY,i.clientX-n.clientX);if(void 0!==this.lastAngle_){const t=r-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=t}this.lastAngle_=r;const s=t.map,o=s.getView();o.getConstraints().rotation!==me&&(this.anchor_=s.getCoordinateFromPixelInternal(s.getEventPixel(si(this.targetPointers))),this.rotating_&&(s.render(),o.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},Ii=class extends oi{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=dt),super(e),this.anchor_=null,this.duration_=void 0!==t.duration?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const n=this.targetPointers[0],i=this.targetPointers[1],r=n.clientX-i.clientX,s=n.clientY-i.clientY,o=Math.sqrt(r*r+s*s);void 0!==this.lastDistance_&&(e=this.lastDistance_/o),this.lastDistance_=o;const a=t.map,l=a.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(si(this.targetPointers))),a.render(),l.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const e=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,n),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}};function Li(t){return t[0]>0&&t[1]>0}function Ti(t){t instanceof cn?t.setMapInternal(null):t instanceof Dn&&t.getLayers().forEach(Ti)}function Si(t,e){if(t instanceof cn)t.setMapInternal(e);else if(t instanceof Dn){const n=t.getLayers().getArray();for(let t=0,i=n.length;t<i;++t)Si(n[t],e)}}const ki=class extends At{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=function(t){let e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const n={},i=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new Dn({layers:t.layers});let r,s,o;return n[qn]=i,n[Bn]=t.target,n[Xn]=t.view instanceof hn?t.view:new hn,void 0!==t.controls&&(Array.isArray(t.controls)?r=new Vt(t.controls.slice()):(Kt("function"==typeof t.controls.getArray,47),r=t.controls)),void 0!==t.interactions&&(Array.isArray(t.interactions)?s=new Vt(t.interactions.slice()):(Kt("function"==typeof t.interactions.getArray,48),s=t.interactions)),void 0!==t.overlays?Array.isArray(t.overlays)?o=new Vt(t.overlays.slice()):(Kt("function"==typeof t.overlays.getArray,49),o=t.overlays):o=new Vt,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:n}}(t);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,this.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:wn,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver((()=>this.updateSize())),this.controls=e.controls||function(t){t=t||{};const e=new Vt;return(void 0===t.zoom||t.zoom)&&e.push(new ti(t.zoomOptions)),(void 0===t.rotate||t.rotate)&&e.push(new Qn(t.rotateOptions)),(void 0===t.attribution||t.attribution)&&e.push(new $n(t.attributionOptions)),e}(),this.interactions=e.interactions||function(t){t=t||{};const e=new Vt,n=new class{constructor(t,e,n){this.decay_=t,this.minVelocity_=e,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let n=e-3;for(;n>0&&this.points_[n+2]>t;)n-=3;const i=this.points_[e+2]-this.points_[n+2];if(i<1e3/60)return!1;const r=this.points_[e]-this.points_[n],s=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(s,r),this.initialVelocity_=Math.sqrt(r*r+s*s)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&e.push(new _i),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&e.push(new ri({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&e.push(new yi({onFocusOnly:t.onFocusOnly,kinetic:n})),(void 0===t.pinchRotate||t.pinchRotate)&&e.push(new Mi),(void 0===t.pinchZoom||t.pinchZoom)&&e.push(new Ii({duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(e.push(new Ei),e.push(new Pi({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&e.push(new Ri({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&e.push(new wi({duration:t.zoomDuration})),e}({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new Wn(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(qn,this.handleLayerGroupChanged_),this.addChangeListener(Xn,this.handleViewChanged_),this.addChangeListener(Un,this.handleSizeChanged_),this.addChangeListener(Bn,this.handleTargetChanged_),this.setProperties(e.values);const n=this;!t.view||t.view instanceof hn||t.view.then((function(t){n.setView(new hn(t))})),this.controls.addEventListener(Ot,(t=>{t.element.setMap(this)})),this.controls.addEventListener(zt,(t=>{t.element.setMap(null)})),this.interactions.addEventListener(Ot,(t=>{t.element.setMap(this)})),this.interactions.addEventListener(zt,(t=>{t.element.setMap(null)})),this.overlays_.addEventListener(Ot,(t=>{this.addOverlayInternal_(t.element)})),this.overlays_.addEventListener(zt,(t=>{const e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)})),this.controls.forEach((t=>{t.setMap(this)})),this.interactions.forEach((t=>{t.setMap(this)})),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){Si(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,n){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(t),r=void 0!==(n=void 0!==n?n:{}).hitTolerance?n.hitTolerance:0,s=void 0!==n.layerFilter?n.layerFilter:ct,o=!1!==n.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,r,o,e,null,s,null)}getFeaturesAtPixel(t,e){const n=[];return this.forEachFeatureAtPixel(t,(function(t){n.push(t)}),e),n}getAllLayers(){const t=[];return function e(n){n.forEach((function(n){n instanceof Dn?e(n.getLayers()):t.push(n)}))}(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const n=this.getCoordinateFromPixelInternal(t),i=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:ct,r=void 0!==e.hitTolerance?e.hitTolerance:0,s=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,r,s,i,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const e=this.viewport_.getBoundingClientRect(),n=this.getSize(),i=e.width/n[0],r=e.height/n[1],s="changedTouches"in t?t.changedTouches[0]:t;return[(s.clientX-e.left)/i,(s.clientY-e.top)/r]}getTarget(){return this.get(Bn)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return $(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?Zt(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(qn)}setLayers(t){const e=this.getLayerGroup();if(t instanceof Vt)return void e.setLayers(t);const n=e.getLayers();n.clear(),n.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const n=t[e];if(!n.visible)continue;const i=n.layer.getRenderer();if(i&&!i.ready)return!0;const r=n.layer.getSource();if(r&&r.loading)return!0}return!1}getPixelFromCoordinate(t){const e=Q(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?Zt(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Un)}getView(){return this.get(Xn)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,n,i){return function(t,e,n,i,r){if(!t||!(n in t.wantedTiles))return Hn;if(!t.wantedTiles[n][e.getKey()])return Hn;const s=t.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}(this.frameState_,t,e,n,i)}handleBrowserEvent(t,e){e=e||t.type;const n=new On(e,this,t);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,n=e.type;if(n===Gn||n===wt||n===xt){const t=this.getOwnerDocument(),n=this.viewport_.getRootNode?this.viewport_.getRootNode():t,i=e.target;if(this.overlayContainerStopEvent_.contains(i)||!(n===t?t.documentElement:n).contains(i))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t)){const e=this.getInteractions().getArray().slice();for(let n=e.length-1;n>=0;n--){const i=e[n];if(i.getMap()===this&&i.getActive()&&this.getTargetElement()&&(!i.handleEvent(t)||t.propagationStopped))break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let n=this.maxTilesLoading_,i=n;if(t){const e=t.viewHints;if(e[0]||e[1]){const e=Date.now()-t.time>8;n=e?0:8,i=e?0:2}}e.getTilesLoading()<n&&(e.reprioritize(),e.loadMoreTiles(n,i))}t&&this.renderer_&&!t.animate&&(!0===this.renderComplete_?(this.hasListener(he)&&this.renderer_.dispatchRenderEvent(he,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new Nn(Zn,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new Nn(Kn,this,t))));const n=this.postRenderFunctions_;for(let e=0,i=n.length;e<i;++e)n[e](this,t);n.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)Rt(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(yt,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(wt,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,In(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const t=this.targetElement_.getRootNode();t instanceof ShadowRoot&&this.resizeObserver_.unobserve(t.host)}const t=this.getTarget(),e="string"==typeof t?document.getElementById(t):t;if(this.targetElement_=e,e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new Sn(this)),this.mapBrowserEventHandler_=new jn(this,this.moveTolerance_);for(const t in zn)this.mapBrowserEventHandler_.addEventListener(zn[t],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(yt,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(wt,this.boundHandleBrowserEvent_,!!En&&{passive:!1});const t=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.targetChangeHandlerKeys_=[Et(t,xt,this.handleBrowserEvent,this),Et(t,bt,this.handleBrowserEvent,this)];const n=e.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.observe(n.host),this.resizeObserver_.observe(e)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Rt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Rt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=Et(t,st,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Et(t,vt,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Rt),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new kn("addlayer",t)),this.layerGroupPropertyListenerKeys_=[Et(t,st,this.render,this),Et(t,vt,this.render,this),Et(t,"addlayer",this.handleLayerAdd_,this),Et(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const n=t[e].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){Ti(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),n=this.getView(),i=this.frameState_;let r=null;if(void 0!==e&&Li(e)&&n&&n.isDef()){const i=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),s=n.getState();if(r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:I(s.center,s.resolution,s.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:s,viewHints:i,wantedTiles:{},mapId:St(this),renderTargets:{}},s.nextCenter&&s.nextResolution){const t=isNaN(s.nextRotation)?s.rotation:s.nextRotation;r.nextExtent=I(s.nextCenter,s.nextResolution,t,e)}}var s,o;this.frameState_=r,this.renderer_.renderFrame(r),r&&(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),i&&(!this.previousExtent_||!A(this.previousExtent_)&&!E(r.extent,this.previousExtent_))&&(this.dispatchEvent(new Nn("movestart",this,i)),this.previousExtent_=C(this.previousExtent_)),this.previousExtent_&&!r.viewHints[0]&&!r.viewHints[1]&&!E(r.extent,this.previousExtent_)&&(this.dispatchEvent(new Nn("moveend",this,r)),s=r.extent,(o=this.previousExtent_)?(o[0]=s[0],o[1]=s[1],o[2]=s[2],o[3]=s[3]):s.slice())),this.dispatchEvent(new Nn(Vn,this,r)),this.renderComplete_=this.hasListener(Kn)||this.hasListener(Zn)||this.hasListener(he)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout((()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()}),0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new kn("removelayer",e)),this.set(qn,t)}setSize(t){this.set(Un,t)}setTarget(t){this.set(Bn,t)}setView(t){if(!t||t instanceof hn)return void this.set(Xn,t);this.set(Xn,new hn);const e=this;t.then((function(t){e.setView(new hn(t))}))}updateSize(){const t=this.getTargetElement();let e;if(t){const n=getComputedStyle(t),i=t.offsetWidth-parseFloat(n.borderLeftWidth)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)-parseFloat(n.borderRightWidth),r=t.offsetHeight-parseFloat(n.borderTopWidth)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)-parseFloat(n.borderBottomWidth);isNaN(i)||isNaN(r)||(e=[i,r],!Li(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&z("No map visible because the map container's width or height are 0."))}const n=this.getSize();!e||n&&ut(e,n)||(this.setSize(e),this.updateViewportSize_())}updateViewportSize_(){const t=this.getView();if(t){let e;const n=getComputedStyle(this.viewport_);n.width&&n.height&&(e=[parseInt(n.width,10),parseInt(n.height,10)]),t.setViewportSize(e)}}};window.ol&&ol.ext&&!ol.ext.input&&(ol.ext.input={});const Ai=class extends At{constructor(t){t=t||{},super();var e,n=this.input=t.input;n||(n=this.input=document.createElement("INPUT"),t.type&&n.setAttribute("type",t.type),void 0!==t.min&&n.setAttribute("min",t.min),void 0!==t.max&&n.setAttribute("max",t.max),void 0!==t.step&&n.setAttribute("step",t.step),t.parent&&t.parent.appendChild(n)),t.disabled&&(n.disabled=!0),void 0!==t.checked&&(n.checked=!!t.checked),void 0!==t.val&&(n.value=t.val),t.hidden&&(n.style.display="none"),n.addEventListener("focus",function(){this.element&&this.element.classList.add("ol-focus")}.bind(this)),n.addEventListener("focusout",function(){this.element&&(e&&clearTimeout(e),e=setTimeout(function(){this.element.classList.remove("ol-focus")}.bind(this),0))}.bind(this))}_listenDrag(t,e){var n=function(n){this.moving=!0,this.element.classList.add("ol-moving");var i=function(n){"pointerup"===n.type&&(document.removeEventListener("pointermove",i),document.removeEventListener("pointerup",i),document.removeEventListener("pointercancel",i),setTimeout(function(){this.moving=!1,this.element.classList.remove("ol-moving")}.bind(this))),n.target===t&&e(n),n.stopPropagation(),n.preventDefault()}.bind(this);document.addEventListener("pointermove",i,!1),document.addEventListener("pointerup",i,!1),document.addEventListener("pointercancel",i,!1),n.stopPropagation(),n.preventDefault()}.bind(this);t.addEventListener("mousedown",n,!1),t.addEventListener("touchstart",n,!1)}setValue(t){void 0!==t&&(this.input.value=t),this.input.dispatchEvent(new Event("change"))}getValue(){return this.input.value}getInputElement(){return this.input}},Fi=class extends Ai{constructor(t){super(t=t||{});var e=this.element=document.createElement("LABEL");t.html instanceof Element?e.appendChild(t.html):void 0!==t.html&&(e.innerHTML=t.html),e.className=("ol-ext-check ol-ext-checkbox "+(t.className||"")).trim(),this.input.parentNode&&this.input.parentNode.insertBefore(e,this.input),e.appendChild(this.input),e.appendChild(document.createElement("SPAN")),t.after&&e.appendChild(document.createTextNode(t.after)),this.input.addEventListener("change",function(){this.dispatchEvent({type:"check",checked:this.input.checked,value:this.input.value})}.bind(this))}isChecked(){return this.input.checked}},Di=class extends Fi{constructor(t){super(t=t||{}),this.element.className=("ol-ext-toggle-switch "+(t.className||"")).trim()}},Ni=class extends Fi{constructor(t){super(t=t||{}),this.element.className=("ol-ext-check ol-ext-radio "+(t.className||"")).trim()}};var Oi={create:function(t,e){var n;if(e=e||{},"TEXT"===t)n=document.createTextNode(e.html||""),e.parent&&e.parent.appendChild(n);else for(var i in n=document.createElement(t),/button/i.test(t)&&n.setAttribute("type","button"),e)switch(i){case"className":e.className&&e.className.trim&&n.setAttribute("class",e.className.trim());break;case"text":n.innerText=e.text;break;case"html":e.html instanceof Element?n.appendChild(e.html):void 0!==e.html&&(n.innerHTML=e.html);break;case"parent":e.parent&&e.parent.appendChild(n);break;case"options":if(/select/i.test(t))for(var r in e.options)Oi.create("OPTION",{html:r,value:e.options[r],parent:n});break;case"style":Oi.setStyle(n,e.style);break;case"change":case"click":Oi.addListener(n,i,e[i]);break;case"on":for(var s in e.on)Oi.addListener(n,s,e.on[s]);break;case"checked":n.checked=!!e.checked;break;default:n.setAttribute(i,e[i])}return n},createSwitch:function(t){var e=Oi.create("INPUT",{type:"checkbox",on:t.on,click:t.click,change:t.change,parent:t.parent}),n=Object.assign({input:e},t||{});return new Di(n),e},createCheck:function(t){var e=Oi.create("INPUT",{name:t.name,type:"radio"===t.type?"radio":"checkbox",on:t.on,parent:t.parent}),n=Object.assign({input:e},t||{});return"radio"===t.type?new Ni(n):new Fi(n),e},setHTML:function(t,e){e instanceof Element?t.appendChild(e):void 0!==e&&(t.innerHTML=e)},appendText:function(t,e){t.appendChild(document.createTextNode(e||""))},addListener:function(t,e,n,i){"string"==typeof e&&(e=e.split(" ")),e.forEach((function(e){t.addEventListener(e,n,i)}))},removeListener:function(t,e,n){"string"==typeof e&&(e=e.split(" ")),e.forEach((function(e){t.removeEventListener(e,n)}))},show:function(t){t.style.display=""},hide:function(t){t.style.display="none"},hidden:function(t){return"none"===Oi.getStyle(t,"display")},toggle:function(t){t.style.display="none"===t.style.display?"":"none"},setStyle:function(t,e){for(var n in e)switch(n){case"top":case"left":case"bottom":case"right":case"minWidth":case"maxWidth":case"width":case"height":"number"==typeof e[n]?t.style[n]=e[n]+"px":t.style[n]=e[n];break;default:t.style[n]=e[n]}},getStyle:function(t,e){var n,i=(t.ownerDocument||document).defaultView;if(i&&i.getComputedStyle)e=e.replace(/([A-Z])/g,"-$1").toLowerCase(),n=i.getComputedStyle(t,null).getPropertyValue(e);else if(t.currentStyle&&(e=e.replace(/-(\w)/g,(function(t,e){return e.toUpperCase()})),n=t.currentStyle[e],/^\d+(em|pt|%|ex)?$/i.test(n)))return function(e){var n=t.style.left,i=t.runtimeStyle.left;return t.runtimeStyle.left=t.currentStyle.left,t.style.left=e||0,e=t.style.pixelLeft+"px",t.style.left=n,t.runtimeStyle.left=i,e}(n);return/px$/.test(n)?parseInt(n):n},outerHeight:function(t){return t.offsetHeight+Oi.getStyle(t,"marginBottom")},outerWidth:function(t){return t.offsetWidth+Oi.getStyle(t,"marginLeft")},offsetRect:function(t){var e=t.getBoundingClientRect();return{top:e.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:e.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0),height:e.height||e.bottom-e.top,width:e.width||e.right-e.left}},getFixedOffset:function(t){var e={left:0,top:0},n=function(t){if(!t)return e;if("absolute"===Oi.getStyle(t,"position")&&"none"!==Oi.getStyle(t,"transform")){var i=t.getBoundingClientRect();return e.left+=i.left,e.top+=i.top,e}return n(t.offsetParent)};return n(t.offsetParent)},positionRect:function(t,e){var n=0,i=0,r=function(s){if(s)return n+=s.offsetLeft,i+=s.offsetTop,r(s.offsetParent);var o={top:t.offsetTop+i,left:t.offsetLeft+n};return e&&(o.top-=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,o.left-=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0),o.bottom=o.top+t.offsetHeight,o.right=o.top+t.offsetWidth,o};return r(t.offsetParent)},scrollDiv:function(t,e){var n,i,r,s,o,a=!1,l=0,h=0,u="function"==typeof(e=e||{}).onmove?e.onmove:function(){},c=e.vertical?"screenY":"screenX",d=e.vertical?"scrollTop":"scrollLeft",p=!1,g=0,f=function(){o&&(g++,setTimeout(m))},m=function(){if(o){if(--g)return;var e=t.clientHeight,n=t.scrollHeight;i=e/n,o.style.height=100*i+"%",o.style.top=t.scrollTop/n*100+"%",s.style.height=e+"px",e>n-.5?s.classList.add("ol-100pc"):s.classList.remove("ol-100pc")}},v=function(e){e.target.classList.contains("ol-noscroll")||(p=!1,a=e[c],h=new Date,t.classList.add("ol-move"),e.preventDefault(),window.addEventListener("pointermove",y),Oi.addListener(window,["pointerup","pointercancel"],b))},y=function(e){if(!1!==a){var s=(r?-1/i:1)*(a-e[c]);p=p||Math.round(s),t[d]+=s,(n=new Date)-h&&(l=(l+s/(n-h))/2),a=e[c],h=n,s&&u(!0)}else p=!0},_=function(e){var n=e>0?Math.min(100,e/2):Math.max(-100,e/2);e-=n,t[d]+=n,-1<e&&e<1?(p?setTimeout((function(){t.classList.remove("ol-move")})):t.classList.remove("ol-move"),p=!1,u(!1)):setTimeout((function(){_(e)}),40)};if(e.vertical&&e.minibar){var x=function(n){t.removeEventListener("pointermove",x),t.parentNode.classList.add("ol-miniscroll"),o=Oi.create("DIV"),s=Oi.create("DIV",{className:"ol-scroll",html:o}),t.parentNode.insertBefore(s,t),o.addEventListener("pointerdown",(function(t){r=!0,v(t)})),e.mousewheel&&(Oi.addListener(s,["mousewheel","DOMMouseScroll","onmousewheel"],(function(t){C(t)})),Oi.addListener(o,["mousewheel","DOMMouseScroll","onmousewheel"],(function(t){C(t)}))),t.parentNode.addEventListener("pointerenter",f),window.addEventListener("resize",f),!1!==n&&f()};t.parentNode?x(!1):t.addEventListener("pointermove",x),t.addEventListener("scroll",(function(){f()}))}t.style["touch-action"]="none",t.style.overflow="hidden",t.classList.add("ol-scrolldiv"),Oi.addListener(t,["pointerdown"],(function(t){r=!1,v(t)})),t.addEventListener("click",(function(e){t.classList.contains("ol-move")&&(e.preventDefault(),e.stopPropagation())}),!0);var b=function(n){(h=new Date-h)>100||r?l=0:h>0&&(l=((l||0)+(a-n[c])/h)/2),_(!1===e.animate?0:200*l),a=!1,l=0,h=0,t.classList.contains("ol-move")?t.classList.remove("ol-hasClick"):(t.classList.add("ol-hasClick"),setTimeout((function(){t.classList.remove("ol-hasClick")}),500)),r=!1,window.removeEventListener("pointermove",y),Oi.removeListener(window,["pointerup","pointercancel"],b)},C=function(e){var n=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));return t.classList.add("ol-move"),t[d]-=30*n,t.classList.remove("ol-move"),!1};return e.mousewheel&&Oi.addListener(t,["mousewheel","DOMMouseScroll","onmousewheel"],C),{refresh:f}},dispatchEvent:function(t,e){var n;try{n=new CustomEvent(t)}catch(e){(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,{})}e.dispatchEvent(n)}};const zi=Oi,Gi="element",ji="map",Vi="offset",Ki="position",Zi="positioning",qi=class extends At{constructor(t){super(),this.on,this.once,this.un,this.options=t,this.id=t.id,this.insertFirst=void 0===t.insertFirst||t.insertFirst,this.stopEvent=void 0===t.stopEvent||t.stopEvent,this.element=document.createElement("div"),this.element.className=void 0!==t.className?t.className:"ol-overlay-container ol-selectable",this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=!0===t.autoPan?{}:t.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(Gi,this.handleElementChanged),this.addChangeListener(ji,this.handleMapChanged),this.addChangeListener(Vi,this.handleOffsetChanged),this.addChangeListener(Ki,this.handlePositionChanged),this.addChangeListener(Zi,this.handlePositioningChanged),void 0!==t.element&&this.setElement(t.element),this.setOffset(void 0!==t.offset?t.offset:[0,0]),this.setPositioning(t.positioning||"top-left"),void 0!==t.position&&this.setPosition(t.position)}getElement(){return this.get(Gi)}getId(){return this.id}getMap(){return this.get(ji)||null}getOffset(){return this.get(Vi)}getPosition(){return this.get(Ki)}getPositioning(){return this.get(Zi)}handleElementChanged(){Ln(this.element);const t=this.getElement();t&&this.element.appendChild(t)}handleMapChanged(){this.mapPostrenderListenerKey&&(In(this.element),Rt(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const t=this.getMap();if(t){this.mapPostrenderListenerKey=Et(t,Vn,this.render,this),this.updatePixelPosition();const e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(t){this.set(Gi,t)}setMap(t){this.set(ji,t)}setOffset(t){this.set(Vi,t)}setPosition(t){this.set(Ki,t)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(t){const e=this.getMap();if(!e||!e.getTargetElement()||!this.get(Ki))return;const n=this.getRect(e.getTargetElement(),e.getSize()),i=this.getElement(),r=this.getRect(i,[Pn(i),Rn(i)]),s=void 0===(t=t||{}).margin?20:t.margin;if(!y(n,r)){const i=r[0]-n[0],o=n[2]-r[2],a=r[1]-n[1],l=n[3]-r[3],h=[0,0];if(i<0?h[0]=i-s:o<0&&(h[0]=Math.abs(o)+s),a<0?h[1]=a-s:l<0&&(h[1]=Math.abs(l)+s),0!==h[0]||0!==h[1]){const n=e.getView().getCenterInternal(),i=e.getPixelFromCoordinateInternal(n);if(!i)return;const r=[i[0]+h[0],i[1]+h[1]],s=t.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(r),duration:s.duration,easing:s.easing})}}}getRect(t,e){const n=t.getBoundingClientRect(),i=n.left+window.pageXOffset,r=n.top+window.pageYOffset;return[i,r,i+e[0],r+e[1]]}setPositioning(t){this.set(Zi,t)}setVisible(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}updatePixelPosition(){const t=this.getMap(),e=this.getPosition();if(!t||!t.isRendered()||!e)return void this.setVisible(!1);const n=t.getPixelFromCoordinate(e),i=t.getSize();this.updateRenderedPosition(n,i)}updateRenderedPosition(t,e){const n=this.element.style,i=this.getOffset(),r=this.getPositioning();this.setVisible(!0);let s="0%",o="0%";"bottom-right"==r||"center-right"==r||"top-right"==r?s="-100%":"bottom-center"!=r&&"center-center"!=r&&"top-center"!=r||(s="-50%"),"bottom-left"==r||"bottom-center"==r||"bottom-right"==r?o="-100%":"center-left"!=r&&"center-center"!=r&&"center-right"!=r||(o="-50%");const a=`translate(${s}, ${o}) translate(${Math.round(t[0]+i[0])+"px"}, ${Math.round(t[1]+i[1])+"px"})`;this.rendered.transform_!=a&&(this.rendered.transform_=a,n.transform=a)}getOptions(){return this.options}};var Ui={getTransform:function(t){var e,n,i=window.getComputedStyle(t,null),r=(i.getPropertyValue("-webkit-transform")||i.getPropertyValue("-moz-transform")||i.getPropertyValue("-ms-transform")||i.getPropertyValue("-o-transform")||i.getPropertyValue("transform")).split("(")[1].split(")")[0].split(","),s=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];if(16===r.length)for(e=0;e<4;++e)for(n=0;n<4;++n)s[n][e]=+r[4*e+n];else for(e=0;e<3;++e)for(n=0;n<2;++n)s[n][e]=+r[2*e+n];return s},getTransformOrigin:function(t){for(var e=window.getComputedStyle(t,null),n=(e.getPropertyValue("-webkit-transform-origin")||e.getPropertyValue("-moz-transform-origin")||e.getPropertyValue("-ms-transform-origin")||e.getPropertyValue("-o-transform-origin")||e.getPropertyValue("transform-origin")).split(" "),i=[0,0,0,1],r=0;r<n.length;++r)i[r]=parseInt(n[r]);return i},translateMatrix:function(t,e,n){return[[1,0,0,t],[0,1,0,e],[0,0,1,n],[0,0,0,1]]},identity:function(){return[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]},roundTo:function(t,e){e||(e=1e-10);for(var n=[[],[],[],[]],i=0;i<4;i++)for(var r=0;r<4;r++)n[i][r]=Math.round(t[i][r]/e)*e;return n},multiply:function(t,e){for(var n=[[],[],[],[]],i=0;i<4;++i)for(var r=0;r<4;++r){for(var s=0,o=0;o<4;++o)s+=t[o][i]*e[r][o];n[r][i]=s}return n},computeTransformMatrix:function(t,e){var n=Ui.translateMatrix(-e[0],-e[1],-e[2]),i=Ui.translateMatrix(e[0],e[1],e[2]),r=Ui.multiply(n,t);return Ui.multiply(r,i)},transformVertex:function(t,e){for(var n=[e[0],e[1],0,1],i=[],r=0;r<4;++r){i[r]=0;for(var s=0;s<4;++s)i[r]+=+t[r][s]*n[s]}return i},projectVertex:function(t){for(var e=[],n=0;n<4;++n)e[n]=t[n]/t[3];return e},inverse:function(t){var e=t[0][0]*t[1][1]-t[1][0]*t[0][1],n=t[0][0]*t[1][2]-t[1][0]*t[0][2],i=t[0][0]*t[1][3]-t[1][0]*t[0][3],r=t[0][1]*t[1][2]-t[1][1]*t[0][2],s=t[0][1]*t[1][3]-t[1][1]*t[0][3],o=t[0][2]*t[1][3]-t[1][2]*t[0][3],a=t[2][2]*t[3][3]-t[3][2]*t[2][3],l=t[2][1]*t[3][3]-t[3][1]*t[2][3],h=t[2][1]*t[3][2]-t[3][1]*t[2][2],u=t[2][0]*t[3][3]-t[3][0]*t[2][3],c=t[2][0]*t[3][2]-t[3][0]*t[2][2],d=t[2][0]*t[3][1]-t[3][0]*t[2][1],p=1/(e*a-n*l+i*h+r*u-s*c+o*d);if(isNaN(p)||p===1/0)throw new Error("Inverse determinant attempted to divide by zero.");return[[(t[1][1]*a-t[1][2]*l+t[1][3]*h)*p,(-t[0][1]*a+t[0][2]*l-t[0][3]*h)*p,(t[3][1]*o-t[3][2]*s+t[3][3]*r)*p,(-t[2][1]*o+t[2][2]*s-t[2][3]*r)*p],[(-t[1][0]*a+t[1][2]*u-t[1][3]*c)*p,(t[0][0]*a-t[0][2]*u+t[0][3]*c)*p,(-t[3][0]*o+t[3][2]*i-t[3][3]*n)*p,(t[2][0]*o-t[2][2]*i+t[2][3]*n)*p],[(t[1][0]*l-t[1][1]*u+t[1][3]*d)*p,(-t[0][0]*l+t[0][1]*u-t[0][3]*d)*p,(t[3][0]*s-t[3][1]*i+t[3][3]*e)*p,(-t[2][0]*s+t[2][1]*i-t[2][3]*e)*p],[(-t[1][0]*h+t[1][1]*c-t[1][2]*d)*p,(t[0][0]*h-t[0][1]*c+t[0][2]*d)*p,(-t[3][0]*r+t[3][1]*n-t[3][2]*e)*p,(t[2][0]*r-t[2][1]*n+t[2][2]*e)*p]]}};const Bi=Ui;var Xi,Hi=class extends ki{constructor(t){var e=t.target instanceof Element?t.target:document.getElementById(t.target);"absolute"!==window.getComputedStyle(e).position&&(e.style.position="relative"),e.style.overflow="hidden";var n=zi.create("DIV",{className:"ol-perspective-map",parent:e}),i={};Object.assign(i,t),i.target=n,super(i),this._tiltCondition=t.tiltCondition||li}getPixelRatio(){return window.devicePixelRatio}setPerspective(t,e){e=e||{},t>30?t=30:t<0&&(t=0);var n=this._angle||0,i=Math.round(10*t)/10,r=this.getTarget().querySelector(".ol-layers").style;cancelAnimationFrame(this._animatedPerspective),requestAnimationFrame(function(t){this._animatePerpective(t,t,r,n,i,e.duration,e.easing||_e)}.bind(this))}_animatePerpective(t,e,n,i,r,s,o){var a,l,h;0===s?(a=1,l=!0):l=(a=(e-t)/(s||500))>=1,a=o(a);var u=(h=this._angle=l?r:i+(r-i)*a)/30;n.transform="translateY(-"+17*u+"%) perspective(200px) rotateX("+h+"deg) scaleY("+(1-u/2)+")",this.getMatrix3D(!0),this.render(),l||requestAnimationFrame(function(e){this._animatePerpective(t,e,n,i,r,s||500,o||_e)}.bind(this)),this.dispatchEvent({type:"change:perspective",angle:h,animating:!l})}handleMapBrowserEvent(t){if(t.pixel=[t.originalEvent.offsetX/this.getPixelRatio(),t.originalEvent.offsetY/this.getPixelRatio()],t.coordinate=this.getCoordinateFromPixel(t.pixel),ki.prototype.handleMapBrowserEvent.call(this,t),this._tiltCondition(t))switch(t.type){case"pointerdown":this._dragging=t.originalEvent.offsetY;break;case"pointerup":this._dragging=!1;break;case"pointerdrag":if(!1!==this._dragging){var e=t.originalEvent.offsetY>this._dragging?.5:-.5;e&&this.setPerspective((this._angle||0)+e,{duration:0}),this._dragging=t.originalEvent.offsetY}}else this._dragging=!1}getMatrix3D(t){if(t){var e=this.getTarget().querySelector(".ol-layers"),n=Bi.getTransform(e),i=Bi.getTransformOrigin(e);this._matrixTransform=Bi.computeTransformMatrix(n,i)}return this._matrixTransform||(this._matrixTransform=Bi.identity()),this._matrixTransform}getPixelScreenFromCoordinate(t){var e=this.getPixelFromCoordinate(t),n=this.getMatrix3D(),i=Bi.transformVertex(n,e);return[(i=Bi.projectVertex(i))[0],i[1]]}getPixelFromPixelScreen(t){var e=Bi.inverse(this.getMatrix3D()),n=Bi.transformVertex(e,t);return[(n=Bi.projectVertex(n))[0],n[1]]}};Xi=qi.prototype.updatePixelPosition,qi.prototype.updatePixelPosition=function(){var t=this.getMap();if(t&&t instanceof Hi){var e=this.getPosition();if(!t||!t.isRendered()||!e)return void this.setVisible(!1);var n=t.getPixelScreenFromCoordinate(e),i=t.getSize();n[0]-=i[0]/4,n[1]-=i[1]/4,this.updateRenderedPosition(n,i)}else Xi.call(this)};class Yi extends At{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new Yi(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const n=this.getStyle();return n&&t.setStyle(n),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Rt(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=Et(t,vt,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;let e;return Array.isArray(t)?e=t:(Kt("function"==typeof t.getZIndex,41),e=[t]),function(){return e}}(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}const Wi=Yi;class Ji extends Ce{constructor(t){super(),this.geometries_=t||null,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Rt),this.changeEventsKeys_.length=0}listenGeometriesChange_(){if(this.geometries_)for(let t=0,e=this.geometries_.length;t<e;++t)this.changeEventsKeys_.push(Et(this.geometries_[t],vt,this.changed,this))}clone(){const t=new Ji(null);return t.setGeometries(this.geometries_),t.applyProperties(this),t}closestPointXY(t,e,n,i){if(i<v(this.getExtent(),t,e))return i;const r=this.geometries_;for(let s=0,o=r.length;s<o;++s)i=r[s].closestPointXY(t,e,n,i);return i}containsXY(t,e){const n=this.geometries_;for(let i=0,r=n.length;i<r;++i)if(n[i].containsXY(t,e))return!0;return!1}computeExtent(t){C(t);const e=this.geometries_;for(let r=0,s=e.length;r<s;++r)n=t,(i=e[r].getExtent())[0]<n[0]&&(n[0]=i[0]),i[2]>n[2]&&(n[2]=i[2]),i[1]<n[1]&&(n[1]=i[1]),i[3]>n[3]&&(n[3]=i[3]);var n,i;return t}getGeometries(){return $i(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let n=0,i=e.length;n<i;++n)e[n].getType()===this.getType()?t=t.concat(e[n].getGeometriesArrayRecursive()):t.push(e[n]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],n=this.geometries_;let i=!1;for(let r=0,s=n.length;r<s;++r){const s=n[r],o=s.getSimplifiedGeometry(t);e.push(o),o!==s&&(i=!0)}if(i){const t=new Ji(null);return t.setGeometriesArray(e),t}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let n=0,i=e.length;n<i;++n)if(e[n].intersectsExtent(t))return!0;return!1}isEmpty(){return 0===this.geometries_.length}rotate(t,e){const n=this.geometries_;for(let i=0,r=n.length;i<r;++i)n[i].rotate(t,e);this.changed()}scale(t,e,n){n||(n=M(this.getExtent()));const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].scale(t,e,n);this.changed()}setGeometries(t){this.setGeometriesArray($i(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let n=0,i=e.length;n<i;++n)e[n].applyTransform(t);this.changed()}translate(t,e){const n=this.geometries_;for(let i=0,r=n.length;i<r;++i)n[i].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function $i(t){const e=[];for(let n=0,i=t.length;n<i;++n)e.push(t[n].clone());return e}const Qi=Ji,tr=class{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let n=e.dataProjection?Z(e.dataProjection):this.readProjection(t);e.extent&&n&&"tile-pixels"===n.getUnits()&&(n=Z(n),n.setWorldExtent(e.extent)),e={dataProjection:n,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},t)}getType(){return Lt()}readFeature(t,e){return Lt()}readFeatures(t,e){return Lt()}readGeometry(t,e){return Lt()}readProjection(t){return Lt()}writeFeature(t,e){return Lt()}writeFeatures(t,e){return Lt()}writeGeometry(t,e){return Lt()}};function er(t,e,n){const i=n?Z(n.featureProjection):null,r=n?Z(n.dataProjection):null;let s;if(s=i&&r&&!function(t,e){if(t===e)return!0;const n=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||B(t,e)===j)&&n}(i,r)?(e?t.clone():t).transform(e?i:r,e?r:i):t,e&&n&&void 0!==n.decimals){const e=Math.pow(10,n.decimals),i=function(t){for(let n=0,i=t.length;n<i;++n)t[n]=Math.round(t[n]*e)/e;return t};s===t&&(s=t.clone()),s.applyTransform(i)}return s}function nr(t){if("string"==typeof t){return JSON.parse(t)||null}return null!==t?t:null}const ir=class extends tr{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(nr(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(nr(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return Lt()}readFeaturesFromObject(t,e){return Lt()}readGeometry(t,e){return this.readGeometryFromObject(nr(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return Lt()}readProjection(t){return this.readProjectionFromObject(nr(t))}readProjectionFromObject(t){return Lt()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return Lt()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return Lt()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return Lt()}};function rr(t,e,n,i,r,s,o){let a,l;const h=(n-e)/i;if(1===h)a=e;else if(2===h)a=e,l=r;else if(0!==h){let s=t[e],o=t[e+1],h=0;const u=[0];for(let r=e+i;r<n;r+=i){const e=t[r],n=t[r+1];h+=Math.sqrt((e-s)*(e-s)+(n-o)*(n-o)),u.push(h),s=e,o=n}const c=r*h,d=function(t,e,n){let i,r;n=n||at;let s=0,o=t.length,a=!1;for(;s<o;)i=s+(o-s>>1),r=+n(t[i],e),r<0?s=i+1:(o=i,a=!r);return a?s:~s}(u,c);d<0?(l=(c-u[-d-2])/(u[-d-1]-u[-d-2]),a=e+(-d-2)*i):a=e+d*i}o=o>1?o:2,s=s||new Array(o);for(let e=0;e<o;++e)s[e]=void 0===a?NaN:void 0===l?t[a+e]:Yt(t[a+e],t[a+i+e],l);return s}function sr(t,e,n,i,r,s){if(n==e)return null;let o;if(r<t[e+i-1])return s?(o=t.slice(e,e+i),o[i-1]=r,o):null;if(t[n-1]<r)return s?(o=t.slice(n-i,n),o[i-1]=r,o):null;if(r==t[e+i-1])return t.slice(e,e+i);let a=e/i,l=n/i;for(;a<l;){const e=a+l>>1;r<t[(e+1)*i-1]?l=e:a=e+1}const h=t[a*i-1];if(r==h)return t.slice((a-1)*i,(a-1)*i+i);const u=(r-h)/(t[(a+1)*i-1]-h);o=[];for(let e=0;e<i-1;++e)o.push(Yt(t[(a-1)*i+e],t[a*i+e],u));return o.push(r),o}class or extends Ee{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}appendCoordinate(t){this.flatCoordinates?ht(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()}clone(){const t=new or(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,i){return i<v(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Re(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ie(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,n,i))}forEachSegment(t){return He(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(e=void 0!==e&&e,sr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return Ne(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return rr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return function(t,e,n,i){let r=t[e],s=t[e+1],o=0;for(let a=e+i;a<n;a+=i){const e=t[a],n=t[a+1];o+=Math.sqrt((e-r)*(e-r)+(n-s)*(n-s)),r=e,s=n}return o}(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=ke(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new or(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return Ye(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Te(this.flatCoordinates,0,t,this.stride),this.changed()}}const ar=or;class lr extends Ee{constructor(t,e,n){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(void 0!==e&&n)this.setFlatCoordinates(e,t),this.ends_=n;else{let e=this.getLayout();const n=t,i=[],r=[];for(let t=0,s=n.length;t<s;++t){const s=n[t];0===t&&(e=s.getLayout()),ht(i,s.getFlatCoordinates()),r.push(i.length)}this.setFlatCoordinates(e,i),this.ends_=r}}appendLineString(t){this.flatCoordinates?ht(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new lr(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,i){return i<v(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Me(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Le(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,n,i))}getCoordinateAtM(t,e,n){return"XYM"!=this.layout&&"XYZM"!=this.layout||0===this.flatCoordinates.length?null:(e=void 0!==e&&e,n=void 0!==n&&n,function(t,e,n,i,r,s,o){if(o)return sr(t,e,n[n.length-1],i,r,s);let a;if(r<t[i-1])return s?(a=t.slice(0,i),a[i-1]=r,a):null;if(t[t.length-1]<r)return s?(a=t.slice(t.length-i),a[i-1]=r,a):null;for(let s=0,o=n.length;s<o;++s){const o=n[s];if(e!=o){if(r<t[e+i-1])return null;if(r<=t[o-1])return sr(t,e,o,i,r,!1);e=o}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,e,n))}getCoordinates(){return Oe(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new ar(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,n=this.layout,i=[];let r=0;for(let s=0,o=e.length;s<o;++s){const o=e[s],a=new ar(t.slice(r,o),n);i.push(a),r=o}return i}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let n=0;const i=this.ends_,r=this.stride;for(let s=0,o=i.length;s<o;++s){const o=i[s];ht(t,rr(e,n,o,r,.5)),n=o}return t}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=function(t,e,n,i,r,s,o,a){for(let l=0,h=n.length;l<h;++l){const h=n[l];o=ke(t,e,h,i,r,s,o),a.push(o),e=h}return o}(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,n),new lr(e,"XY",n)}getType(){return"MultiLineString"}intersectsExtent(t){return function(t,e,n,i,r){for(let s=0,o=n.length;s<o;++s){if(Ye(t,e,n[s],i,r))return!0;e=n[s]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=Se(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()}}const hr=lr;class ur extends Ee{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){this.flatCoordinates?ht(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()}clone(){const t=new ur(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,i){if(i<v(this.getExtent(),t,e))return i;const r=this.flatCoordinates,s=this.stride;for(let o=0,a=r.length;o<a;o+=s){const a=Xt(t,e,r[o],r[o+1]);if(a<i){i=a;for(let t=0;t<s;++t)n[t]=r[o+t];n.length=s}}return i}getCoordinates(){return Ne(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new Ze(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,n=this.stride,i=[];for(let r=0,s=t.length;r<s;r+=n){const s=new Ze(t.slice(r,r+n),e);i.push(s)}return i}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,n=this.stride;for(let i=0,r=e.length;i<r;i+=n)if(_(t,e[i],e[i+1]))return!0;return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Te(this.flatCoordinates,0,t,this.stride),this.changed()}}const cr=ur;class dr extends Ee{constructor(t,e,n){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!n&&!Array.isArray(t[0])){let i=this.getLayout();const r=t,s=[],o=[];for(let t=0,e=r.length;t<e;++t){const e=r[t];0===t&&(i=e.getLayout());const n=s.length,a=e.getEnds();for(let t=0,e=a.length;t<e;++t)a[t]+=n;ht(s,e.getFlatCoordinates()),o.push(a)}e=i,t=s,n=o}void 0!==e&&n?(this.setFlatCoordinates(e,t),this.endss_=n):this.setCoordinates(t,e)}appendPolygon(t){let e;if(this.flatCoordinates){const n=this.flatCoordinates.length;ht(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let t=0,i=e.length;t<i;++t)e[t]+=n}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let n=0;n<t;++n)e[n]=this.endss_[n].slice();const n=new dr(this.flatCoordinates.slice(),this.layout,e);return n.applyProperties(this),n}closestPointXY(t,e,n,i){return i<v(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,n,i,r){for(let s=0,o=n.length;s<o;++s){const o=n[s];r=Me(t,e,o,i,r),e=o[o.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,n,i,r,s,o,a,l,h,u){u=u||[NaN,NaN];for(let s=0,c=n.length;s<c;++s){const c=n[s];h=Le(t,e,c,i,r,true,o,a,l,h,u),e=c[c.length-1]}return h}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,0,t,e,n,i))}containsXY(t,e){return function(t,e,n,i,r,s){if(0===n.length)return!1;for(let o=0,a=n.length;o<a;++o){const a=n[o];if(Be(t,e,a,i,r,s))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return function(t,e,n,i){let r=0;for(let s=0,o=n.length;s<o;++s){const o=n[s];r+=Ge(t,e,o,i),e=o[o.length-1]}return r}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),en(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,function(t,e,n,i,r){r=void 0!==r?r:[];let s=0;for(let o=0,a=n.length;o<a;++o){const a=n[o];r[s++]=1===a.length&&a[0]===e?[]:Oe(t,e,a,i,r[s]),e=a[a.length-1]}return r.length=s,r}(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=function(t,e,n,i){const r=[];let s=[1/0,1/0,-1/0,-1/0];for(let o=0,a=n.length;o<a;++o){const a=n[o];s=w(t,e,a[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=a[a.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=function(t,e,n,i,r){let s=[];for(let o=0,a=n.length;o<a;++o){const a=n[o];s=Xe(t,e,a,i,r,2*o,s),e=a[a.length-1]}return s}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new cr(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;!function(t,e,n,i,r){for(let r=0,s=n.length;r<s;++r){const s=n[r];if(!Qe(t,e,s,i,undefined))return!1;s.length&&(e=s[s.length-1])}return!0}(t,0,this.endss_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=en(this.orientedFlatCoordinates_,0,this.endss_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=function(t,e,n,i,r,s,o,a){for(let l=0,h=n.length;l<h;++l){const h=n[l],u=[];o=De(t,e,h,i,r,s,o,u),a.push(u),e=h[h.length-1]}return o}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,n),new dr(e,"XY",n)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(0===t)e=0;else{const n=this.endss_[t-1];e=n[n.length-1]}const n=this.endss_[t].slice(),i=n[n.length-1];if(0!==e)for(let t=0,i=n.length;t<i;++t)n[t]-=e;return new rn(this.flatCoordinates.slice(e,i),this.layout,n)}getPolygons(){const t=this.layout,e=this.flatCoordinates,n=this.endss_,i=[];let r=0;for(let s=0,o=n.length;s<o;++s){const o=n[s].slice(),a=o[o.length-1];if(0!==r)for(let t=0,e=o.length;t<e;++t)o[t]-=r;const l=new rn(e.slice(r,a),t,o);i.push(l),r=a}return i}getType(){return"MultiPolygon"}intersectsExtent(t){return function(t,e,n,i,r){for(let s=0,o=n.length;s<o;++s){const o=n[s];if(We(t,e,o,i,r))return!0;e=o[o.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const n=function(t,e,n,i,r){r=r||[];let s=0;for(let o=0,a=n.length;o<a;++o){const a=Se(t,e,n[o],i,r[s]);0===a.length&&(a[0]=e),r[s++]=a,e=a[a.length-1]}return r.length=s,r}(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===n.length)this.flatCoordinates.length=0;else{const t=n[n.length-1];this.flatCoordinates.length=0===t.length?0:t[t.length-1]}this.changed()}}const pr=dr;function gr(t,e){if(!t)return null;let n;switch(t.type){case"Point":n=function(t){return new Ze(t.coordinates)}(t);break;case"LineString":n=function(t){return new ar(t.coordinates)}(t);break;case"Polygon":n=function(t){return new rn(t.coordinates)}(t);break;case"MultiPoint":n=function(t){return new cr(t.coordinates)}(t);break;case"MultiLineString":n=function(t){return new hr(t.coordinates)}(t);break;case"MultiPolygon":n=function(t){return new pr(t.coordinates)}(t);break;case"GeometryCollection":n=function(t,e){const n=t.geometries.map((function(t){return gr(t,undefined)}));return new Qi(n)}(t);break;default:throw new Error("Unsupported GeoJSON type: "+t.type)}return er(n,!1,e)}function fr(t,e){const n=(t=er(t,!0,e)).getType();let i;switch(n){case"Point":i=function(t,e){return{type:"Point",coordinates:t.getCoordinates()}}(t);break;case"LineString":i=function(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}(t);break;case"Polygon":i=function(t,e){let n;return e&&(n=e.rightHanded),{type:"Polygon",coordinates:t.getCoordinates(n)}}(t,e);break;case"MultiPoint":i=function(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}(t);break;case"MultiLineString":i=function(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}(t);break;case"MultiPolygon":i=function(t,e){let n;return e&&(n=e.rightHanded),{type:"MultiPolygon",coordinates:t.getCoordinates(n)}}(t,e);break;case"GeometryCollection":i=function(t,e){delete(e=Object.assign({},e)).featureProjection;return{type:"GeometryCollection",geometries:t.getGeometriesArray().map((function(t){return fr(t,e)}))}}(t,e);break;case"Circle":i={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+n)}return i}var mr,vr={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function yr(t){return(t=Math.round(t))<0?0:t>255?255:t}function _r(t){return t<0?0:t>1?1:t}function xr(t){return"%"===t[t.length-1]?yr(parseFloat(t)/100*255):yr(parseInt(t))}function br(t){return"%"===t[t.length-1]?_r(parseFloat(t)/100):_r(parseFloat(t))}function Cr(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{mr={}.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in vr)return vr[n].slice();if("#"===n[0])return 4===n.length?(e=parseInt(n.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===n.length&&(e=parseInt(n.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var i=n.indexOf("("),r=n.indexOf(")");if(-1!==i&&r+1===n.length){var s=n.substr(0,i),o=n.substr(i+1,r-(i+1)).split(","),a=1;switch(s){case"rgba":if(4!==o.length)return null;a=br(o.pop());case"rgb":return 3!==o.length?null:[xr(o[0]),xr(o[1]),xr(o[2]),a];case"hsla":if(4!==o.length)return null;a=br(o.pop());case"hsl":if(3!==o.length)return null;var l=(parseFloat(o[0])%360+360)%360/360,h=br(o[1]),u=br(o[2]),c=u<=.5?u*(h+1):u+h-u*h,d=2*u-c;return[yr(255*Cr(d,c,l+1/3)),yr(255*Cr(d,c,l)),yr(255*Cr(d,c,l-1/3)),a];default:return null}}return null}}catch(t){}var wr=function(t,e,n,i){void 0===i&&(i=1),this.r=t,this.g=e,this.b=n,this.a=i};wr.parse=function(t){if(t){if(t instanceof wr)return t;if("string"==typeof t){var e=mr(t);if(e)return new wr(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},wr.prototype.toString=function(){var t=this.toArray(),e=t[0],n=t[1],i=t[2],r=t[3];return"rgba("+Math.round(e)+","+Math.round(n)+","+Math.round(i)+","+r+")"},wr.prototype.toArray=function(){var t=this,e=t.r,n=t.g,i=t.b,r=t.a;return 0===r?[0,0,0,0]:[255*e/r,255*n/r,255*i/r,r]},wr.prototype.toArray01=function(){var t=this,e=t.r,n=t.g,i=t.b,r=t.a;return 0===r?[0,0,0,0]:[e/r,n/r,i/r,r]},wr.prototype.toArray01PremultipliedAlpha=function(){var t=this;return[t.r,t.g,t.b,t.a]},wr.black=new wr(0,0,0,1),wr.white=new wr(1,1,1,1),wr.transparent=new wr(0,0,0,0),wr.red=new wr(1,0,0,1),wr.blue=new wr(0,0,1,1);var Er=wr,Pr=function(t){function e(e,n){t.call(this,n),this.message=n,this.key=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),Rr=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var n=0,i=e;n<i.length;n+=1){var r=i[n],s=r[0],o=r[1];this.bindings[s]=o}};Rr.prototype.concat=function(t){return new Rr(this,t)},Rr.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},Rr.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Mr=Rr,Ir={kind:"null"},Lr={kind:"number"},Tr={kind:"string"},Sr={kind:"boolean"},kr={kind:"color"},Ar={kind:"object"},Fr={kind:"value"},Dr={kind:"collator"},Nr={kind:"formatted"},Or={kind:"resolvedImage"};function zr(t,e){return{kind:"array",itemType:t,N:e}}function Gr(t){if("array"===t.kind){var e=Gr(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}var jr=[Ir,Lr,Tr,Sr,kr,Nr,Ar,zr(Fr),Or];function Vr(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!Vr(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var n=0,i=jr;n<i.length;n+=1)if(!Vr(i[n],e))return null}return"Expected "+Gr(t)+" but found "+Gr(e)+" instead."}function Kr(t,e){return e.some((function(e){return e.kind===t.kind}))}function Zr(t,e){return e.some((function(e){return"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t}))}var qr=function(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};qr.prototype.compare=function(t,e){return this.collator.compare(t,e)},qr.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Ur=qr,Br=function(t,e,n,i,r){this.text=t.normalize?t.normalize():t,this.image=e,this.scale=n,this.fontStack=i,this.textColor=r},Xr=function(t){this.sections=t};Xr.fromString=function(t){return new Xr([new Br(t,null,null,null,null)])},Xr.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some((function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length}))},Xr.factory=function(t){return t instanceof Xr?t:Xr.fromString(t)},Xr.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map((function(t){return t.text})).join("")},Xr.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var i=n[e];if(i.image)t.push(["image",i.image.name]);else{t.push(i.text);var r={};i.fontStack&&(r["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(r["font-scale"]=i.scale),i.textColor&&(r["text-color"]=["rgba"].concat(i.textColor.toArray())),t.push(r)}}return t};var Hr=Xr,Yr=function(t){this.name=t.name,this.available=t.available};Yr.prototype.toString=function(){return this.name},Yr.fromString=function(t){return t?new Yr({name:t,available:!1}):null},Yr.prototype.serialize=function(){return["image",this.name]};var Wr=Yr;function Jr(t,e,n,i){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:"Invalid rgba value ["+[t,e,n,i].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof i?[t,e,n,i]:[t,e,n]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function $r(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof Er)return!0;if(t instanceof Ur)return!0;if(t instanceof Hr)return!0;if(t instanceof Wr)return!0;if(Array.isArray(t)){for(var e=0,n=t;e<n.length;e+=1)if(!$r(n[e]))return!1;return!0}if("object"==typeof t){for(var i in t)if(!$r(t[i]))return!1;return!0}return!1}function Qr(t){if(null===t)return Ir;if("string"==typeof t)return Tr;if("boolean"==typeof t)return Sr;if("number"==typeof t)return Lr;if(t instanceof Er)return kr;if(t instanceof Ur)return Dr;if(t instanceof Hr)return Nr;if(t instanceof Wr)return Or;if(Array.isArray(t)){for(var e,n=t.length,i=0,r=t;i<r.length;i+=1){var s=Qr(r[i]);if(e){if(e===s)continue;e=Fr;break}e=s}return zr(e||Fr,n)}return Ar}function ts(t){var e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof Er||t instanceof Hr||t instanceof Wr?t.toString():JSON.stringify(t)}var es=function(t,e){this.type=t,this.value=e};es.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!$r(t[1]))return e.error("invalid value");var n=t[1],i=Qr(n),r=e.expectedType;return"array"!==i.kind||0!==i.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(i=r),new es(i,n)},es.prototype.evaluate=function(){return this.value},es.prototype.eachChild=function(){},es.prototype.outputDefined=function(){return!0},es.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Er?["rgba"].concat(this.value.toArray()):this.value instanceof Hr?this.value.serialize():this.value};var ns=es,is=function(t){this.name="ExpressionEvaluationError",this.message=t};is.prototype.toJSON=function(){return this.message};var rs=is,ss={string:Tr,number:Lr,boolean:Sr,object:Ar},os=function(t,e){this.type=t,this.args=e};os.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n,i=1,r=t[0];if("array"===r){var s,o;if(t.length>2){var a=t[1];if("string"!=typeof a||!(a in ss)||"object"===a)return e.error('The item type argument of "array" must be one of string, number, boolean',1);s=ss[a],i++}else s=Fr;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);o=t[2],i++}n=zr(s,o)}else n=ss[r];for(var l=[];i<t.length;i++){var h=e.parse(t[i],i,Fr);if(!h)return null;l.push(h)}return new os(n,l)},os.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var n=this.args[e].evaluate(t);if(!Vr(this.type,Qr(n)))return n;if(e===this.args.length-1)throw new rs("Expected value to be of type "+Gr(this.type)+", but found "+Gr(Qr(n))+" instead.")}return null},os.prototype.eachChild=function(t){this.args.forEach(t)},os.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},os.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var n=t.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){e.push(n.kind);var i=t.N;("number"==typeof i||this.args.length>1)&&e.push(i)}}return e.concat(this.args.map((function(t){return t.serialize()})))};var as=os,ls=function(t){this.type=Nr,this.sections=t};ls.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");for(var i=[],r=!1,s=1;s<=t.length-1;++s){var o=t[s];if(r&&"object"==typeof o&&!Array.isArray(o)){r=!1;var a=null;if(o["font-scale"]&&!(a=e.parse(o["font-scale"],1,Lr)))return null;var l=null;if(o["text-font"]&&!(l=e.parse(o["text-font"],1,zr(Tr))))return null;var h=null;if(o["text-color"]&&!(h=e.parse(o["text-color"],1,kr)))return null;var u=i[i.length-1];u.scale=a,u.font=l,u.textColor=h}else{var c=e.parse(t[s],1,Fr);if(!c)return null;var d=c.type.kind;if("string"!==d&&"value"!==d&&"null"!==d&&"resolvedImage"!==d)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,i.push({content:c,scale:null,font:null,textColor:null})}}return new ls(i)},ls.prototype.evaluate=function(t){return new Hr(this.sections.map((function(e){var n=e.content.evaluate(t);return Qr(n)===Or?new Br("",n,null,null,null):new Br(ts(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))},ls.prototype.eachChild=function(t){for(var e=0,n=this.sections;e<n.length;e+=1){var i=n[e];t(i.content),i.scale&&t(i.scale),i.font&&t(i.font),i.textColor&&t(i.textColor)}},ls.prototype.outputDefined=function(){return!1},ls.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var i=n[e];t.push(i.content.serialize());var r={};i.scale&&(r["font-scale"]=i.scale.serialize()),i.font&&(r["text-font"]=i.font.serialize()),i.textColor&&(r["text-color"]=i.textColor.serialize()),t.push(r)}return t};var hs=ls,us=function(t){this.type=Or,this.input=t};us.parse=function(t,e){if(2!==t.length)return e.error("Expected two arguments.");var n=e.parse(t[1],1,Tr);return n?new us(n):e.error("No image name provided.")},us.prototype.evaluate=function(t){var e=this.input.evaluate(t),n=Wr.fromString(e);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(e)>-1),n},us.prototype.eachChild=function(t){t(this.input)},us.prototype.outputDefined=function(){return!1},us.prototype.serialize=function(){return["image",this.input.serialize()]};var cs=us,ds={"to-boolean":Sr,"to-color":kr,"to-number":Lr,"to-string":Tr},ps=function(t,e){this.type=t,this.args=e};ps.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");for(var i=ds[n],r=[],s=1;s<t.length;s++){var o=e.parse(t[s],s,Fr);if(!o)return null;r.push(o)}return new ps(i,r)},ps.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,n,i=0,r=this.args;i<r.length;i+=1){if(n=null,(e=r[i].evaluate(t))instanceof Er)return e;if("string"==typeof e){var s=t.parseColor(e);if(s)return s}else if(Array.isArray(e)&&!(n=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":Jr(e[0],e[1],e[2],e[3])))return new Er(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new rs(n||"Could not parse color from value '"+("string"==typeof e?e:String(JSON.stringify(e)))+"'")}if("number"===this.type.kind){for(var o=null,a=0,l=this.args;a<l.length;a+=1){if(null===(o=l[a].evaluate(t)))return 0;var h=Number(o);if(!isNaN(h))return h}throw new rs("Could not convert "+JSON.stringify(o)+" to number.")}return"formatted"===this.type.kind?Hr.fromString(ts(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?Wr.fromString(ts(this.args[0].evaluate(t))):ts(this.args[0].evaluate(t))},ps.prototype.eachChild=function(t){this.args.forEach(t)},ps.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},ps.prototype.serialize=function(){if("formatted"===this.type.kind)return new hs([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new cs(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild((function(e){t.push(e.serialize())})),t};var gs=ps,fs=["Unknown","Point","LineString","Polygon"],ms=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null};ms.prototype.id=function(){return this.feature&&void 0!==this.feature.id?this.feature.id:null},ms.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?fs[this.feature.type]:this.feature.type:null},ms.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ms.prototype.canonicalID=function(){return this.canonical},ms.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ms.prototype.distanceFromCenter=function(){if(this.featureTileCoord&&this.featureDistanceData){var t=this.featureDistanceData.center,e=this.featureDistanceData.scale,n=this.featureTileCoord,i=n.x,r=n.y,s=i*e-t[0],o=r*e-t[1];return this.featureDistanceData.bearing[0]*s+this.featureDistanceData.bearing[1]*o}return 0},ms.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Er.parse(t)),e};var vs=ms,ys=function(t,e,n,i){this.name=t,this.type=e,this._evaluate=n,this.args=i};ys.prototype.evaluate=function(t){return this._evaluate(t,this.args)},ys.prototype.eachChild=function(t){this.args.forEach(t)},ys.prototype.outputDefined=function(){return!1},ys.prototype.serialize=function(){return[this.name].concat(this.args.map((function(t){return t.serialize()})))},ys.parse=function(t,e){var n,i=t[0],r=ys.definitions[i];if(!r)return e.error('Unknown expression "'+i+'". If you wanted a literal array, use ["literal", [...]].',0);for(var s=Array.isArray(r)?r[0]:r.type,o=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,a=o.filter((function(e){var n=e[0];return!Array.isArray(n)||n.length===t.length-1})),l=null,h=0,u=a;h<u.length;h+=1){var c=u[h],d=c[0],p=c[1];l=new Bs(e.registry,e.path,null,e.scope);for(var g=[],f=!1,m=1;m<t.length;m++){var v=t[m],y=Array.isArray(d)?d[m-1]:d.type,_=l.parse(v,1+g.length,y);if(!_){f=!0;break}g.push(_)}if(!f)if(Array.isArray(d)&&d.length!==g.length)l.error("Expected "+d.length+" arguments, but found "+g.length+" instead.");else{for(var x=0;x<g.length;x++){var b=Array.isArray(d)?d[x]:d.type,C=g[x];l.concat(x+1).checkSubtype(b,C.type)}if(0===l.errors.length)return new ys(i,s,p,g)}}if(1===a.length)(n=e.errors).push.apply(n,l.errors);else{for(var w=(a.length?a:o).map((function(t){var e;return e=t[0],Array.isArray(e)?"("+e.map(Gr).join(", ")+")":"("+Gr(e.type)+"...)"})).join(" | "),E=[],P=1;P<t.length;P++){var R=e.parse(t[P],1+E.length);if(!R)return null;E.push(Gr(R.type))}e.error("Expected arguments of type "+w+", but found ("+E.join(", ")+") instead.")}return null},ys.register=function(t,e){for(var n in ys.definitions=e,e)t[n]=ys};var _s=ys,xs=function(t,e,n){this.type=Dr,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e};xs.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");var i=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,Sr);if(!i)return null;var r=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,Sr);if(!r)return null;var s=null;return n.locale&&!(s=e.parse(n.locale,1,Tr))?null:new xs(i,r,s)},xs.prototype.evaluate=function(t){return new Ur(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},xs.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},xs.prototype.outputDefined=function(){return!1},xs.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var bs=xs,Cs=8192;function ws(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Es(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Ps(t,e){var n,i=(180+t[0])/360,r=(n=t[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360),s=Math.pow(2,e.z);return[Math.round(i*s*Cs),Math.round(r*s*Cs)]}function Rs(t,e,n){return e[1]>t[1]!=n[1]>t[1]&&t[0]<(n[0]-e[0])*(t[1]-e[1])/(n[1]-e[1])+e[0]}function Ms(t,e){for(var n,i,r,s,o,a,l,h=!1,u=0,c=e.length;u<c;u++)for(var d=e[u],p=0,g=d.length;p<g-1;p++){if(n=t,i=d[p],r=d[p+1],void 0,void 0,void 0,void 0,s=n[0]-i[0],o=n[1]-i[1],a=n[0]-r[0],s*(l=n[1]-r[1])-a*o==0&&s*a<=0&&o*l<=0)return!1;Rs(t,d[p],d[p+1])&&(h=!h)}return h}function Is(t,e){for(var n=0;n<e.length;n++)if(Ms(t,e[n]))return!0;return!1}function Ls(t,e,n,i){var r=t[0]-n[0],s=t[1]-n[1],o=e[0]-n[0],a=e[1]-n[1],l=i[0]-n[0],h=i[1]-n[1],u=r*h-l*s,c=o*h-l*a;return u>0&&c<0||u<0&&c>0}function Ts(t,e,n){for(var i=0,r=n;i<r.length;i+=1)for(var s=r[i],o=0;o<s.length-1;++o)if(a=t,l=e,h=s[o],u=s[o+1],void 0,void 0,void 0,void 0,p=[l[0]-a[0],l[1]-a[1]],0!=(c=[u[0]-h[0],u[1]-h[1]])[0]*(d=p)[1]-c[1]*d[0]&&Ls(a,l,h,u)&&Ls(h,u,a,l))return!0;var a,l,h,u,c,d,p;return!1}function Ss(t,e){for(var n=0;n<t.length;++n)if(!Ms(t[n],e))return!1;for(var i=0;i<t.length-1;++i)if(Ts(t[i],t[i+1],e))return!1;return!0}function ks(t,e){for(var n=0;n<e.length;n++)if(Ss(t,e[n]))return!0;return!1}function As(t,e,n){for(var i=[],r=0;r<t.length;r++){for(var s=[],o=0;o<t[r].length;o++){var a=Ps(t[r][o],n);ws(e,a),s.push(a)}i.push(s)}return i}function Fs(t,e,n){for(var i=[],r=0;r<t.length;r++){var s=As(t[r],e,n);i.push(s)}return i}function Ds(t,e,n,i){if(t[0]<n[0]||t[0]>n[2]){var r=.5*i,s=t[0]-n[0]>r?-i:n[0]-t[0]>r?i:0;0===s&&(s=t[0]-n[2]>r?-i:n[2]-t[0]>r?i:0),t[0]+=s}ws(e,t)}function Ns(t,e,n,i){var r=Math.pow(2,i.z)*Cs,s=[i.x*Cs,i.y*Cs],o=[];if(!t)return o;for(var a=0,l=t;a<l.length;a+=1)for(var h=0,u=l[a];h<u.length;h+=1){var c=u[h],d=[c.x+s[0],c.y+s[1]];Ds(d,e,n,r),o.push(d)}return o}function Os(t,e,n,i){var r,s=Math.pow(2,i.z)*Cs,o=[i.x*Cs,i.y*Cs],a=[];if(!t)return a;for(var l=0,h=t;l<h.length;l+=1){for(var u=[],c=0,d=h[l];c<d.length;c+=1){var p=d[c],g=[p.x+o[0],p.y+o[1]];ws(e,g),u.push(g)}a.push(u)}if(e[2]-e[0]<=s/2){(r=e)[0]=r[1]=1/0,r[2]=r[3]=-1/0;for(var f=0,m=a;f<m.length;f+=1)for(var v=0,y=m[f];v<y.length;v+=1)Ds(y[v],e,n,s)}return a}var zs=function(t,e){this.type=Sr,this.geojson=t,this.geometries=e};zs.parse=function(t,e){if(2!==t.length)return e.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if($r(t[1])){var n=t[1];if("FeatureCollection"===n.type)for(var i=0;i<n.features.length;++i){var r=n.features[i].geometry.type;if("Polygon"===r||"MultiPolygon"===r)return new zs(n,n.features[i].geometry)}else if("Feature"===n.type){var s=n.geometry.type;if("Polygon"===s||"MultiPolygon"===s)return new zs(n,n.geometry)}else if("Polygon"===n.type||"MultiPolygon"===n.type)return new zs(n,n)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")},zs.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){var n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if(!r)return!1;if("Polygon"===e.type){var s=As(e.coordinates,i,r),o=Ns(t.geometry(),n,i,r);if(!Es(n,i))return!1;for(var a=0,l=o;a<l.length;a+=1)if(!Ms(l[a],s))return!1}if("MultiPolygon"===e.type){var h=Fs(e.coordinates,i,r),u=Ns(t.geometry(),n,i,r);if(!Es(n,i))return!1;for(var c=0,d=u;c<d.length;c+=1)if(!Is(d[c],h))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){var n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if(!r)return!1;if("Polygon"===e.type){var s=As(e.coordinates,i,r),o=Os(t.geometry(),n,i,r);if(!Es(n,i))return!1;for(var a=0,l=o;a<l.length;a+=1)if(!Ss(l[a],s))return!1}if("MultiPolygon"===e.type){var h=Fs(e.coordinates,i,r),u=Os(t.geometry(),n,i,r);if(!Es(n,i))return!1;for(var c=0,d=u;c<d.length;c+=1)if(!ks(d[c],h))return!1}return!0}(t,this.geometries)}return!1},zs.prototype.eachChild=function(){},zs.prototype.outputDefined=function(){return!0},zs.prototype.serialize=function(){return["within",this.geojson]};var Gs=zs;function js(t){if(t instanceof _s){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof Gs)return!1;var e=!0;return t.eachChild((function(t){e&&!js(t)&&(e=!1)})),e}function Vs(t){if(t instanceof _s&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild((function(t){e&&!Vs(t)&&(e=!1)})),e}function Ks(t,e){if(t instanceof _s&&e.indexOf(t.name)>=0)return!1;var n=!0;return t.eachChild((function(t){n&&!Ks(t,e)&&(n=!1)})),n}var Zs=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};Zs.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var n=t[1];return e.scope.has(n)?new Zs(n,e.scope.get(n)):e.error('Unknown variable "'+n+'". Make sure "'+n+'" has been bound in an enclosing "let" expression before using it.',1)},Zs.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Zs.prototype.eachChild=function(){},Zs.prototype.outputDefined=function(){return!1},Zs.prototype.serialize=function(){return["var",this.name]};var qs=Zs,Us=function(t,e,n,i,r){void 0===e&&(e=[]),void 0===i&&(i=new Mr),void 0===r&&(r=[]),this.registry=t,this.path=e,this.key=e.map((function(t){return"["+t+"]"})).join(""),this.scope=i,this.errors=r,this.expectedType=n};Us.prototype.parse=function(t,e,n,i,r){return void 0===r&&(r={}),e?this.concat(e,n,i)._parse(t,r):this._parse(t,r)},Us.prototype._parse=function(t,e){function n(t,e,n){return"assert"===n?new as(e,[t]):"coerce"===n?new gs(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var i=t[0];if("string"!=typeof i)return this.error("Expression name must be a string, but found "+typeof i+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var r=this.registry[i];if(r){var s=r.parse(t,this);if(!s)return null;if(this.expectedType){var o=this.expectedType,a=s.type;if("string"!==o.kind&&"number"!==o.kind&&"boolean"!==o.kind&&"object"!==o.kind&&"array"!==o.kind||"value"!==a.kind)if("color"!==o.kind&&"formatted"!==o.kind&&"resolvedImage"!==o.kind||"value"!==a.kind&&"string"!==a.kind){if(this.checkSubtype(o,a))return null}else s=n(s,o,e.typeAnnotation||"coerce");else s=n(s,o,e.typeAnnotation||"assert")}if(!(s instanceof ns)&&"resolvedImage"!==s.type.kind&&Xs(s)){var l=new vs;try{s=new ns(s.type,s.evaluate(l))}catch(t){return this.error(t.message),null}}return s}return this.error('Unknown expression "'+i+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"==typeof t?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof t+" instead.")},Us.prototype.concat=function(t,e,n){var i="number"==typeof t?this.path.concat(t):this.path,r=n?this.scope.concat(n):this.scope;return new Us(this.registry,i,e||null,r,this.errors)},Us.prototype.error=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];var i=""+this.key+e.map((function(t){return"["+t+"]"})).join("");this.errors.push(new Pr(i,t))},Us.prototype.checkSubtype=function(t,e){var n=Vr(t,e);return n&&this.error(n),n};var Bs=Us;function Xs(t){if(t instanceof qs)return Xs(t.boundExpression);if(t instanceof _s&&"error"===t.name)return!1;if(t instanceof bs)return!1;if(t instanceof Gs)return!1;var e=t instanceof gs||t instanceof as,n=!0;return t.eachChild((function(t){n=e?n&&Xs(t):n&&t instanceof ns})),!!n&&js(t)&&Ks(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Hs(t,e){for(var n,i,r=t.length-1,s=0,o=r,a=0;s<=o;)if(n=t[a=Math.floor((s+o)/2)],i=t[a+1],n<=e){if(a===r||e<i)return a;s=a+1}else{if(!(n>e))throw new rs("Input is not a number.");o=a-1}return 0}var Ys=function(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var i=0,r=n;i<r.length;i+=1){var s=r[i],o=s[0],a=s[1];this.labels.push(o),this.outputs.push(a)}};Ys.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var n=e.parse(t[1],1,Lr);if(!n)return null;var i=[],r=null;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var s=1;s<t.length;s+=2){var o=1===s?-1/0:t[s],a=t[s+1],l=s,h=s+1;if("number"!=typeof o)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',l);if(i.length&&i[i.length-1][0]>=o)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',l);var u=e.parse(a,h,r);if(!u)return null;r=r||u.type,i.push([o,u])}return new Ys(r,n,i)},Ys.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);var r=e.length;return i>=e[r-1]?n[r-1].evaluate(t):n[Hs(e,i)].evaluate(t)},Ys.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},Ys.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},Ys.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var Ws=Ys,Js=$s;function $s(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=n,this.p2y=i}function Qs(t,e,n){return t*(1-n)+e*n}$s.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},$s.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},$s.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},$s.prototype.solveCurveX=function(t,e){var n,i,r,s,o;for(void 0===e&&(e=1e-6),r=t,o=0;o<8;o++){if(s=this.sampleCurveX(r)-t,Math.abs(s)<e)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r-=s/a}if((r=t)<(n=0))return n;if(r>(i=1))return i;for(;n<i;){if(s=this.sampleCurveX(r),Math.abs(s-t)<e)return r;t>s?n=r:i=r,r=.5*(i-n)+n}return r},$s.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var to=Object.freeze({__proto__:null,number:Qs,color:function(t,e,n){return new Er(Qs(t.r,e.r,n),Qs(t.g,e.g,n),Qs(t.b,e.b,n),Qs(t.a,e.a,n))},array:function(t,e,n){return t.map((function(t,i){return Qs(t,e[i],n)}))}}),eo=.95047,no=1,io=1.08883,ro=4/29,so=6/29,oo=3*so*so,ao=so*so*so,lo=Math.PI/180,ho=180/Math.PI;function uo(t){return t>ao?Math.pow(t,1/3):t/oo+ro}function co(t){return t>so?t*t*t:oo*(t-ro)}function po(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function go(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function fo(t){var e=go(t.r),n=go(t.g),i=go(t.b),r=uo((.4124564*e+.3575761*n+.1804375*i)/eo),s=uo((.2126729*e+.7151522*n+.072175*i)/no);return{l:116*s-16,a:500*(r-s),b:200*(s-uo((.0193339*e+.119192*n+.9503041*i)/io)),alpha:t.a}}function mo(t){var e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,i=isNaN(t.b)?e:e-t.b/200;return e=no*co(e),n=eo*co(n),i=io*co(i),new Er(po(3.2404542*n-1.5371385*e-.4985314*i),po(-.969266*n+1.8760108*e+.041556*i),po(.0556434*n-.2040259*e+1.0572252*i),t.alpha)}function vo(t,e,n){var i=e-t;return t+n*(i>180||i<-180?i-360*Math.round(i/360):i)}var yo={forward:fo,reverse:mo,interpolate:function(t,e,n){return{l:Qs(t.l,e.l,n),a:Qs(t.a,e.a,n),b:Qs(t.b,e.b,n),alpha:Qs(t.alpha,e.alpha,n)}}},_o=function(t){var e=fo(t),n=e.l,i=e.a,r=e.b,s=Math.atan2(r,i)*ho;return{h:s<0?s+360:s,c:Math.sqrt(i*i+r*r),l:n,alpha:t.a}},xo=function(t){var e=t.h*lo,n=t.c;return mo({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},bo=function(t,e,n){return{h:vo(t.h,e.h,n),c:Qs(t.c,e.c,n),l:Qs(t.l,e.l,n),alpha:Qs(t.alpha,e.alpha,n)}},Co=function(t,e,n,i,r){this.type=t,this.operator=e,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(var s=0,o=r;s<o.length;s+=1){var a=o[s],l=a[0],h=a[1];this.labels.push(l),this.outputs.push(h)}};function wo(t,e,n,i){var r=i-n,s=t-n;return 0===r?0:1===e?s/r:(Math.pow(e,s)-1)/(Math.pow(e,r)-1)}Co.interpolationFactor=function(t,e,n,i){var r=0;if("exponential"===t.name)r=wo(e,t.base,n,i);else if("linear"===t.name)r=wo(e,1,n,i);else if("cubic-bezier"===t.name){var s=t.controlPoints;r=new Js(s[0],s[1],s[2],s[3]).solve(wo(e,1,n,i))}return r},Co.parse=function(t,e){var n=t[0],i=t[1],r=t[2],s=t.slice(3);if(!Array.isArray(i)||0===i.length)return e.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){var o=i[1];if("number"!=typeof o)return e.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:o}}else{if("cubic-bezier"!==i[0])return e.error("Unknown interpolation type "+String(i[0]),1,0);var a=i.slice(1);if(4!==a.length||a.some((function(t){return"number"!=typeof t||t<0||t>1})))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:a}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(r=e.parse(r,2,Lr)))return null;var l=[],h=null;"interpolate-hcl"===n||"interpolate-lab"===n?h=kr:e.expectedType&&"value"!==e.expectedType.kind&&(h=e.expectedType);for(var u=0;u<s.length;u+=2){var c=s[u],d=s[u+1],p=u+3,g=u+4;if("number"!=typeof c)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(l.length&&l[l.length-1][0]>=c)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',p);var f=e.parse(d,g,h);if(!f)return null;h=h||f.type,l.push([c,f])}return"number"===h.kind||"color"===h.kind||"array"===h.kind&&"number"===h.itemType.kind&&"number"==typeof h.N?new Co(h,n,i,r,l):e.error("Type "+Gr(h)+" is not interpolatable.")},Co.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);var r=e.length;if(i>=e[r-1])return n[r-1].evaluate(t);var s=Hs(e,i),o=e[s],a=e[s+1],l=Co.interpolationFactor(this.interpolation,i,o,a),h=n[s].evaluate(t),u=n[s+1].evaluate(t);return"interpolate"===this.operator?to[this.type.kind.toLowerCase()](h,u,l):"interpolate-hcl"===this.operator?xo(bo(_o(h),_o(u),l)):yo.reverse(yo.interpolate(yo.forward(h),yo.forward(u),l))},Co.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},Co.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},Co.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],n=0;n<this.labels.length;n++)e.push(this.labels[n],this.outputs[n].serialize());return e};var Eo=Co,Po=function(t,e){this.type=t,this.args=e};Po.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var n=null,i=e.expectedType;i&&"value"!==i.kind&&(n=i);for(var r=[],s=0,o=t.slice(1);s<o.length;s+=1){var a=o[s],l=e.parse(a,1+r.length,n,void 0,{typeAnnotation:"omit"});if(!l)return null;n=n||l.type,r.push(l)}var h=i&&r.some((function(t){return Vr(i,t.type)}));return new Po(h?Fr:n,r)},Po.prototype.evaluate=function(t){for(var e,n=null,i=0,r=0,s=this.args;r<s.length;r+=1){if(i++,(n=s[r].evaluate(t))&&n instanceof Wr&&!n.available&&(e||(e=n),n=null,i===this.args.length))return e;if(null!==n)break}return n},Po.prototype.eachChild=function(t){this.args.forEach(t)},Po.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},Po.prototype.serialize=function(){var t=["coalesce"];return this.eachChild((function(e){t.push(e.serialize())})),t};var Ro=Po,Mo=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};Mo.prototype.evaluate=function(t){return this.result.evaluate(t)},Mo.prototype.eachChild=function(t){for(var e=0,n=this.bindings;e<n.length;e+=1)t(n[e][1]);t(this.result)},Mo.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var n=[],i=1;i<t.length-1;i+=2){var r=t[i];if("string"!=typeof r)return e.error("Expected string, but found "+typeof r+" instead.",i);if(/[^a-zA-Z0-9_]/.test(r))return e.error("Variable names must contain only alphanumeric characters or '_'.",i);var s=e.parse(t[i+1],i+1);if(!s)return null;n.push([r,s])}var o=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return o?new Mo(n,o):null},Mo.prototype.outputDefined=function(){return this.result.outputDefined()},Mo.prototype.serialize=function(){for(var t=["let"],e=0,n=this.bindings;e<n.length;e+=1){var i=n[e],r=i[0],s=i[1];t.push(r,s.serialize())}return t.push(this.result.serialize()),t};var Io=Mo,Lo=function(t,e,n){this.type=t,this.index=e,this.input=n};Lo.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Lr),i=e.parse(t[2],2,zr(e.expectedType||Fr));if(!n||!i)return null;var r=i.type;return new Lo(r.itemType,n,i)},Lo.prototype.evaluate=function(t){var e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new rs("Array index out of bounds: "+e+" < 0.");if(e>=n.length)throw new rs("Array index out of bounds: "+e+" > "+(n.length-1)+".");if(e!==Math.floor(e))throw new rs("Array index must be an integer, but found "+e+" instead.");return n[e]},Lo.prototype.eachChild=function(t){t(this.index),t(this.input)},Lo.prototype.outputDefined=function(){return!1},Lo.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var To=Lo,So=function(t,e){this.type=Sr,this.needle=t,this.haystack=e};So.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Fr),i=e.parse(t[2],2,Fr);return n&&i?Kr(n.type,[Sr,Tr,Lr,Ir,Fr])?new So(n,i):e.error("Expected first argument to be of type boolean, string, number or null, but found "+Gr(n.type)+" instead"):null},So.prototype.evaluate=function(t){var e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(null==n)return!1;if(!Zr(e,["boolean","string","number","null"]))throw new rs("Expected first argument to be of type boolean, string, number or null, but found "+Gr(Qr(e))+" instead.");if(!Zr(n,["string","array"]))throw new rs("Expected second argument to be of type array or string, but found "+Gr(Qr(n))+" instead.");return n.indexOf(e)>=0},So.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},So.prototype.outputDefined=function(){return!0},So.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var ko=So,Ao=function(t,e,n){this.type=Lr,this.needle=t,this.haystack=e,this.fromIndex=n};Ao.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Fr),i=e.parse(t[2],2,Fr);if(!n||!i)return null;if(!Kr(n.type,[Sr,Tr,Lr,Ir,Fr]))return e.error("Expected first argument to be of type boolean, string, number or null, but found "+Gr(n.type)+" instead");if(4===t.length){var r=e.parse(t[3],3,Lr);return r?new Ao(n,i,r):null}return new Ao(n,i)},Ao.prototype.evaluate=function(t){var e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!Zr(e,["boolean","string","number","null"]))throw new rs("Expected first argument to be of type boolean, string, number or null, but found "+Gr(Qr(e))+" instead.");if(!Zr(n,["string","array"]))throw new rs("Expected second argument to be of type array or string, but found "+Gr(Qr(n))+" instead.");if(this.fromIndex){var i=this.fromIndex.evaluate(t);return n.indexOf(e,i)}return n.indexOf(e)},Ao.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},Ao.prototype.outputDefined=function(){return!1},Ao.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Fo=Ao,Do=function(t,e,n,i,r,s){this.inputType=t,this.type=e,this.input=n,this.cases=i,this.outputs=r,this.otherwise=s};Do.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var n,i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(var r={},s=[],o=2;o<t.length-1;o+=2){var a=t[o],l=t[o+1];Array.isArray(a)||(a=[a]);var h=e.concat(o);if(0===a.length)return h.error("Expected at least one branch label.");for(var u=0,c=a;u<c.length;u+=1){var d=c[u];if("number"!=typeof d&&"string"!=typeof d)return h.error("Branch labels must be numbers or strings.");if("number"==typeof d&&Math.abs(d)>Number.MAX_SAFE_INTEGER)return h.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof d&&Math.floor(d)!==d)return h.error("Numeric branch labels must be integer values.");if(n){if(h.checkSubtype(n,Qr(d)))return null}else n=Qr(d);if(void 0!==r[String(d)])return h.error("Branch labels must be unique.");r[String(d)]=s.length}var p=e.parse(l,o,i);if(!p)return null;i=i||p.type,s.push(p)}var g=e.parse(t[1],1,Fr);if(!g)return null;var f=e.parse(t[t.length-1],t.length-1,i);return f?"value"!==g.type.kind&&e.concat(1).checkSubtype(n,g.type)?null:new Do(n,i,g,r,s,f):null},Do.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(Qr(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},Do.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},Do.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))&&this.otherwise.outputDefined()},Do.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],n=[],i={},r=0,s=Object.keys(this.cases).sort();r<s.length;r+=1){var o=s[r];void 0===(c=i[this.cases[o]])?(i[this.cases[o]]=n.length,n.push([this.cases[o],[o]])):n[c][1].push(o)}for(var a=function(e){return"number"===t.inputType.kind?Number(e):e},l=0,h=n;l<h.length;l+=1){var u=h[l],c=u[0],d=u[1];1===d.length?e.push(a(d[0])):e.push(d.map(a)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e};var No=Do,Oo=function(t,e,n){this.type=t,this.branches=e,this.otherwise=n};Oo.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var i=[],r=1;r<t.length-1;r+=2){var s=e.parse(t[r],r,Sr);if(!s)return null;var o=e.parse(t[r+1],r+1,n);if(!o)return null;i.push([s,o]),n=n||o.type}var a=e.parse(t[t.length-1],t.length-1,n);return a?new Oo(n,i,a):null},Oo.prototype.evaluate=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var i=n[e],r=i[0],s=i[1];if(r.evaluate(t))return s.evaluate(t)}return this.otherwise.evaluate(t)},Oo.prototype.eachChild=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var i=n[e],r=i[0],s=i[1];t(r),t(s)}t(this.otherwise)},Oo.prototype.outputDefined=function(){return this.branches.every((function(t){return t[0],t[1].outputDefined()}))&&this.otherwise.outputDefined()},Oo.prototype.serialize=function(){var t=["case"];return this.eachChild((function(e){t.push(e.serialize())})),t};var zo=Oo,Go=function(t,e,n,i){this.type=t,this.input=e,this.beginIndex=n,this.endIndex=i};Go.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Fr),i=e.parse(t[2],2,Lr);if(!n||!i)return null;if(!Kr(n.type,[zr(Fr),Tr,Fr]))return e.error("Expected first argument to be of type array or string, but found "+Gr(n.type)+" instead");if(4===t.length){var r=e.parse(t[3],3,Lr);return r?new Go(n.type,n,i,r):null}return new Go(n.type,n,i)},Go.prototype.evaluate=function(t){var e=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!Zr(e,["string","array"]))throw new rs("Expected first argument to be of type array or string, but found "+Gr(Qr(e))+" instead.");if(this.endIndex){var i=this.endIndex.evaluate(t);return e.slice(n,i)}return e.slice(n)},Go.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},Go.prototype.outputDefined=function(){return!1},Go.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var jo=Go;function Vo(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Ko(t,e,n,i){return 0===i.compare(e,n)}function Zo(t,e,n){var i="=="!==t&&"!="!==t;return function(){function r(t,e,n){this.type=Sr,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}return r.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var n=t[0],s=e.parse(t[1],1,Fr);if(!s)return null;if(!Vo(n,s.type))return e.concat(1).error('"'+n+"\" comparisons are not supported for type '"+Gr(s.type)+"'.");var o=e.parse(t[2],2,Fr);if(!o)return null;if(!Vo(n,o.type))return e.concat(2).error('"'+n+"\" comparisons are not supported for type '"+Gr(o.type)+"'.");if(s.type.kind!==o.type.kind&&"value"!==s.type.kind&&"value"!==o.type.kind)return e.error("Cannot compare types '"+Gr(s.type)+"' and '"+Gr(o.type)+"'.");i&&("value"===s.type.kind&&"value"!==o.type.kind?s=new as(o.type,[s]):"value"!==s.type.kind&&"value"===o.type.kind&&(o=new as(s.type,[o])));var a=null;if(4===t.length){if("string"!==s.type.kind&&"string"!==o.type.kind&&"value"!==s.type.kind&&"value"!==o.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(a=e.parse(t[3],3,Dr)))return null}return new r(s,o,a)},r.prototype.evaluate=function(r){var s=this.lhs.evaluate(r),o=this.rhs.evaluate(r);if(i&&this.hasUntypedArgument){var a=Qr(s),l=Qr(o);if(a.kind!==l.kind||"string"!==a.kind&&"number"!==a.kind)throw new rs('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+a.kind+", "+l.kind+") instead.")}if(this.collator&&!i&&this.hasUntypedArgument){var h=Qr(s),u=Qr(o);if("string"!==h.kind||"string"!==u.kind)return e(r,s,o)}return this.collator?n(r,s,o,this.collator.evaluate(r)):e(r,s,o)},r.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},r.prototype.outputDefined=function(){return!0},r.prototype.serialize=function(){var e=[t];return this.eachChild((function(t){e.push(t.serialize())})),e},r}()}var qo=Zo("==",(function(t,e,n){return e===n}),Ko),Uo=Zo("!=",(function(t,e,n){return e!==n}),(function(t,e,n,i){return!Ko(0,e,n,i)})),Bo=Zo("<",(function(t,e,n){return e<n}),(function(t,e,n,i){return i.compare(e,n)<0})),Xo=Zo(">",(function(t,e,n){return e>n}),(function(t,e,n,i){return i.compare(e,n)>0})),Ho=Zo("<=",(function(t,e,n){return e<=n}),(function(t,e,n,i){return i.compare(e,n)<=0})),Yo=Zo(">=",(function(t,e,n){return e>=n}),(function(t,e,n,i){return i.compare(e,n)>=0})),Wo=function(t,e,n,i,r,s){this.type=Tr,this.number=t,this.locale=e,this.currency=n,this.unit=i,this.minFractionDigits=r,this.maxFractionDigits=s};Wo.parse=function(t,e){if(3!==t.length)return e.error("Expected two arguments.");var n=e.parse(t[1],1,Lr);if(!n)return null;var i=t[2];if("object"!=typeof i||Array.isArray(i))return e.error("NumberFormat options argument must be an object.");var r=null;if(i.locale&&!(r=e.parse(i.locale,1,Tr)))return null;var s=null;if(i.currency&&!(s=e.parse(i.currency,1,Tr)))return null;var o=null;if(i.unit&&!(o=e.parse(i.unit,1,Tr)))return null;var a=null;if(i["min-fraction-digits"]&&!(a=e.parse(i["min-fraction-digits"],1,Lr)))return null;var l=null;return i["max-fraction-digits"]&&!(l=e.parse(i["max-fraction-digits"],1,Lr))?null:new Wo(n,r,s,o,a,l)},Wo.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},Wo.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},Wo.prototype.outputDefined=function(){return!1},Wo.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var Jo=Wo,$o=function(t){this.type=Lr,this.input=t};$o.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error("Expected argument of type string or array, but found "+Gr(n.type)+" instead."):new $o(n):null},$o.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new rs("Expected value to be of type string or array, but found "+Gr(Qr(e))+" instead.")},$o.prototype.eachChild=function(t){t(this.input)},$o.prototype.outputDefined=function(){return!1},$o.prototype.serialize=function(){var t=["length"];return this.eachChild((function(e){t.push(e.serialize())})),t};var Qo={"==":qo,"!=":Uo,">":Xo,"<":Bo,">=":Yo,"<=":Ho,array:as,at:To,boolean:as,case:zo,coalesce:Ro,collator:bs,format:hs,image:cs,in:ko,"index-of":Fo,interpolate:Eo,"interpolate-hcl":Eo,"interpolate-lab":Eo,length:$o,let:Io,literal:ns,match:No,number:as,"number-format":Jo,object:as,slice:jo,step:Ws,string:as,"to-boolean":gs,"to-color":gs,"to-number":gs,"to-string":gs,var:qs,within:Gs};function ta(t,e){var n=e[0],i=e[1],r=e[2],s=e[3];n=n.evaluate(t),i=i.evaluate(t),r=r.evaluate(t);var o=s?s.evaluate(t):1,a=Jr(n,i,r,o);if(a)throw new rs(a);return new Er(n/255*o,i/255*o,r/255*o,o)}function ea(t,e){return t in e}function na(t,e){var n=e[t];return void 0===n?null:n}function ia(t){return{type:t}}_s.register(Qo,{error:[{kind:"error"},[Tr],function(t,e){var n=e[0];throw new rs(n.evaluate(t))}],typeof:[Tr,[Fr],function(t,e){return Gr(Qr(e[0].evaluate(t)))}],"to-rgba":[zr(Lr,4),[kr],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[kr,[Lr,Lr,Lr],ta],rgba:[kr,[Lr,Lr,Lr,Lr],ta],has:{type:Sr,overloads:[[[Tr],function(t,e){return ea(e[0].evaluate(t),t.properties())}],[[Tr,Ar],function(t,e){var n=e[0],i=e[1];return ea(n.evaluate(t),i.evaluate(t))}]]},get:{type:Fr,overloads:[[[Tr],function(t,e){return na(e[0].evaluate(t),t.properties())}],[[Tr,Ar],function(t,e){var n=e[0],i=e[1];return na(n.evaluate(t),i.evaluate(t))}]]},"feature-state":[Fr,[Tr],function(t,e){return na(e[0].evaluate(t),t.featureState||{})}],properties:[Ar,[],function(t){return t.properties()}],"geometry-type":[Tr,[],function(t){return t.geometryType()}],id:[Fr,[],function(t){return t.id()}],zoom:[Lr,[],function(t){return t.globals.zoom}],pitch:[Lr,[],function(t){return t.globals.pitch||0}],"distance-from-center":[Lr,[],function(t){return t.distanceFromCenter()}],"heatmap-density":[Lr,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[Lr,[],function(t){return t.globals.lineProgress||0}],"sky-radial-progress":[Lr,[],function(t){return t.globals.skyRadialProgress||0}],accumulated:[Fr,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[Lr,ia(Lr),function(t,e){for(var n=0,i=0,r=e;i<r.length;i+=1)n+=r[i].evaluate(t);return n}],"*":[Lr,ia(Lr),function(t,e){for(var n=1,i=0,r=e;i<r.length;i+=1)n*=r[i].evaluate(t);return n}],"-":{type:Lr,overloads:[[[Lr,Lr],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)-i.evaluate(t)}],[[Lr],function(t,e){return-e[0].evaluate(t)}]]},"/":[Lr,[Lr,Lr],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)/i.evaluate(t)}],"%":[Lr,[Lr,Lr],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)%i.evaluate(t)}],ln2:[Lr,[],function(){return Math.LN2}],pi:[Lr,[],function(){return Math.PI}],e:[Lr,[],function(){return Math.E}],"^":[Lr,[Lr,Lr],function(t,e){var n=e[0],i=e[1];return Math.pow(n.evaluate(t),i.evaluate(t))}],sqrt:[Lr,[Lr],function(t,e){var n=e[0];return Math.sqrt(n.evaluate(t))}],log10:[Lr,[Lr],function(t,e){var n=e[0];return Math.log(n.evaluate(t))/Math.LN10}],ln:[Lr,[Lr],function(t,e){var n=e[0];return Math.log(n.evaluate(t))}],log2:[Lr,[Lr],function(t,e){var n=e[0];return Math.log(n.evaluate(t))/Math.LN2}],sin:[Lr,[Lr],function(t,e){var n=e[0];return Math.sin(n.evaluate(t))}],cos:[Lr,[Lr],function(t,e){var n=e[0];return Math.cos(n.evaluate(t))}],tan:[Lr,[Lr],function(t,e){var n=e[0];return Math.tan(n.evaluate(t))}],asin:[Lr,[Lr],function(t,e){var n=e[0];return Math.asin(n.evaluate(t))}],acos:[Lr,[Lr],function(t,e){var n=e[0];return Math.acos(n.evaluate(t))}],atan:[Lr,[Lr],function(t,e){var n=e[0];return Math.atan(n.evaluate(t))}],min:[Lr,ia(Lr),function(t,e){return Math.min.apply(Math,e.map((function(e){return e.evaluate(t)})))}],max:[Lr,ia(Lr),function(t,e){return Math.max.apply(Math,e.map((function(e){return e.evaluate(t)})))}],abs:[Lr,[Lr],function(t,e){var n=e[0];return Math.abs(n.evaluate(t))}],round:[Lr,[Lr],function(t,e){var n=e[0].evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[Lr,[Lr],function(t,e){var n=e[0];return Math.floor(n.evaluate(t))}],ceil:[Lr,[Lr],function(t,e){var n=e[0];return Math.ceil(n.evaluate(t))}],"filter-==":[Sr,[Tr,Fr],function(t,e){var n=e[0],i=e[1];return t.properties()[n.value]===i.value}],"filter-id-==":[Sr,[Fr],function(t,e){var n=e[0];return t.id()===n.value}],"filter-type-==":[Sr,[Tr],function(t,e){var n=e[0];return t.geometryType()===n.value}],"filter-<":[Sr,[Tr,Fr],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],s=i.value;return typeof r==typeof s&&r<s}],"filter-id-<":[Sr,[Fr],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i<r}],"filter->":[Sr,[Tr,Fr],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],s=i.value;return typeof r==typeof s&&r>s}],"filter-id->":[Sr,[Fr],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i>r}],"filter-<=":[Sr,[Tr,Fr],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],s=i.value;return typeof r==typeof s&&r<=s}],"filter-id-<=":[Sr,[Fr],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i<=r}],"filter->=":[Sr,[Tr,Fr],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],s=i.value;return typeof r==typeof s&&r>=s}],"filter-id->=":[Sr,[Fr],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i>=r}],"filter-has":[Sr,[Fr],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[Sr,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[Sr,[zr(Tr)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[Sr,[zr(Fr)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[Sr,[Tr,zr(Fr)],function(t,e){var n=e[0];return e[1].value.indexOf(t.properties()[n.value])>=0}],"filter-in-large":[Sr,[Tr,zr(Fr)],function(t,e){var n=e[0],i=e[1];return function(t,e,n,i){for(;n<=i;){var r=n+i>>1;if(e[r]===t)return!0;e[r]>t?i=r-1:n=r+1}return!1}(t.properties()[n.value],i.value,0,i.value.length-1)}],all:{type:Sr,overloads:[[[Sr,Sr],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)&&i.evaluate(t)}],[ia(Sr),function(t,e){for(var n=0,i=e;n<i.length;n+=1)if(!i[n].evaluate(t))return!1;return!0}]]},any:{type:Sr,overloads:[[[Sr,Sr],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)||i.evaluate(t)}],[ia(Sr),function(t,e){for(var n=0,i=e;n<i.length;n+=1)if(i[n].evaluate(t))return!0;return!1}]]},"!":[Sr,[Sr],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[Sr,[Tr],function(t,e){var n=e[0],i=t.globals&&t.globals.isSupportedScript;return!i||i(n.evaluate(t))}],upcase:[Tr,[Tr],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[Tr,[Tr],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[Tr,ia(Fr),function(t,e){return e.map((function(e){return ts(e.evaluate(t))})).join("")}],"resolved-locale":[Tr,[Dr],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var ra=function(t,e){var n,i;this.expression=t,this._warningHistory={},this._evaluator=new vs,this._defaultValue=e?"color"===(n=e).type&&("object"==typeof(i=n.default)&&null!==i&&!Array.isArray(i)||Array.isArray(n.default))?new Er(0,0,0,0):"color"===n.type?Er.parse(n.default)||null:void 0===n.default?null:n.default:null,this._enumValues=e&&"enum"===e.type?e.values:null};ra.prototype.evaluateWithoutErrorHandling=function(t,e,n,i,r,s,o,a){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.canonical=i||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=s,this._evaluator.featureTileCoord=o||null,this._evaluator.featureDistanceData=a||null,this.expression.evaluate(this._evaluator)},ra.prototype.evaluate=function(t,e,n,i,r,s,o,a){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=s||null,this._evaluator.featureTileCoord=o||null,this._evaluator.featureDistanceData=a||null;try{var l=this.expression.evaluate(this._evaluator);if(null==l||"number"==typeof l&&l!=l)return this._defaultValue;if(this._enumValues&&!(l in this._enumValues))throw new rs("Expected value to be one of "+Object.keys(this._enumValues).map((function(t){return JSON.stringify(t)})).join(", ")+", but found "+JSON.stringify(l)+" instead.");return l}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var sa=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Vs(e.expression)};sa.prototype.evaluateWithoutErrorHandling=function(t,e,n,i,r,s){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,r,s)},sa.prototype.evaluate=function(t,e,n,i,r,s){return this._styleExpression.evaluate(t,e,n,i,r,s)};var oa=function(t,e,n,i){this.kind=t,this.zoomStops=n,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Vs(e.expression),this.interpolationType=i};oa.prototype.evaluateWithoutErrorHandling=function(t,e,n,i,r,s){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,r,s)},oa.prototype.evaluate=function(t,e,n,i,r,s){return this._styleExpression.evaluate(t,e,n,i,r,s)},oa.prototype.interpolationFactor=function(t,e,n){return this.interpolationType?Eo.interpolationFactor(this.interpolationType,t,e,n):0},new Set(["in","==","!=",">",">=","<","<=","to-boolean"]),function(){for(var t=[],e=78271.51696402048;t.length<=24;e/=2)t.push(e)}(),Array(256).join(" "),new class extends ir{constructor(t){t=t||{},super(),this.dataProjection=Z(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=Z(t.featureProjection)),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let n=null;n="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null};const i=gr(n.geometry,e),r=new Wi;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in n!==void 0&&r.setGeometryName(n.geometry_name),r.setGeometry(i),"id"in n&&r.setId(n.id),n.properties&&r.setProperties(n.properties,!0),r}readFeaturesFromObject(t,e){let n=null;if("FeatureCollection"===t.type){n=[];const i=t.features;for(let t=0,r=i.length;t<r;++t)n.push(this.readFeatureFromObject(i[t],e))}else n=[this.readFeatureFromObject(t,e)];return n}readGeometryFromObject(t,e){return gr(t,e)}readProjectionFromObject(t){const e=t.crs;let n;return e?"name"==e.type?n=Z(e.properties.name):"EPSG"===e.type?n=Z("EPSG:"+e.properties.code):Kt(!1,36):n=this.dataProjection,n}writeFeatureObject(t,e){e=this.adaptOptions(e);const n={type:"Feature",geometry:null,properties:null},i=t.getId();if(void 0!==i&&(n.id=i),!t.hasProperties())return n;const r=t.getProperties(),s=t.getGeometry();return s&&(n.geometry=fr(s,e),delete r[t.getGeometryName()]),ft(r)||(n.properties=r),n}writeFeaturesObject(t,e){e=this.adaptOptions(e);const n=[];for(let i=0,r=t.length;i<r;++i)n.push(this.writeFeatureObject(t[i],e));return{type:"FeatureCollection",features:n}}writeGeometryObject(t,e){return fr(t,this.adaptOptions(e))}}})();